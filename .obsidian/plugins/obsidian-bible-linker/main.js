/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __markAsModule = (target) => __defProp(target, "__esModule", { value: true });
var __export = (target, all) => {
  __markAsModule(target);
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __reExport = (target, module2, desc) => {
  if (module2 && typeof module2 === "object" || typeof module2 === "function") {
    for (let key of __getOwnPropNames(module2))
      if (!__hasOwnProp.call(target, key) && key !== "default")
        __defProp(target, key, { get: () => module2[key], enumerable: !(desc = __getOwnPropDesc(module2, key)) || desc.enumerable });
  }
  return target;
};
var __toModule = (module2) => {
  return __reExport(__markAsModule(__defProp(module2 != null ? __create(__getProtoOf(module2)) : {}, "default", module2 && module2.__esModule && "default" in module2 ? { get: () => module2.default, enumerable: true } : { value: module2, enumerable: true })), module2);
};
var __async = (__this, __arguments, generator) => {
  return new Promise((resolve, reject) => {
    var fulfilled = (value) => {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    };
    var rejected = (value) => {
      try {
        step(generator.throw(value));
      } catch (e) {
        reject(e);
      }
    };
    var step = (x) => x.done ? resolve(x.value) : Promise.resolve(x.value).then(fulfilled, rejected);
    step((generator = generator.apply(__this, __arguments)).next());
  });
};

// src/main.ts
__export(exports, {
  default: () => BibleLinkerPlugin
});
var import_obsidian7 = __toModule(require("obsidian"));

// src/modals/copy-verse-modal.ts
var import_obsidian3 = __toModule(require("obsidian"));

// src/logic/copy-command.ts
var import_obsidian2 = __toModule(require("obsidian"));

// src/utils/regexes.ts
var oneVerseRegEx = new RegExp(/([^,:#]+)[,#.:;]\s*(\d+)\s*$/);
var multipleVersesRegEx = new RegExp(/([^,:#]+)[,#.:;]\s*(\d+)\s*[-.=]\s*(\d+)\s*$/);
var bookAndChapterRegexForOBSK = /([^,:#]+)\s(\d+)/;
var multipleChapters = /(\d*[^\d,:#]+)\s*(\d+)\s*-\s*(\d+)\s*$/;
var isOBSKFile = /([a-zA-Z0-9 ]+)-(\d{2,3})/;

// src/logic/common.ts
var import_obsidian = __toModule(require("obsidian"));
function capitalize(str) {
  str = str.toLocaleLowerCase();
  for (let i = 0; i < str.length; i++) {
    if (/[^\s\d.,#-]/.test(str.charAt(i))) {
      return str.slice(0, i) + str.charAt(i).toUpperCase() + str.slice(i + 1);
    }
  }
  return str;
}
function parseUserVerseInput(userInput, verbose = true) {
  let bookAndChapter;
  let beginVerse;
  let endVerse;
  switch (true) {
    case oneVerseRegEx.test(userInput): {
      const [, matchedChapter, matchedVerse] = userInput.match(oneVerseRegEx);
      bookAndChapter = matchedChapter;
      beginVerse = Number(matchedVerse);
      endVerse = Number(matchedVerse);
      break;
    }
    case multipleVersesRegEx.test(userInput): {
      const [, matchedChapter, matchedBeginVerse, matchedEndVerse] = userInput.match(multipleVersesRegEx);
      bookAndChapter = matchedChapter;
      beginVerse = Number(matchedBeginVerse);
      endVerse = Number(matchedEndVerse);
      break;
    }
    default: {
      if (verbose) {
        new import_obsidian.Notice(`Wrong format "${userInput}"`);
      }
      throw "Could not parse user input";
    }
  }
  return { bookAndChapter, beginVerse, endVerse };
}
function parseUserBookInput(userInput) {
  let book;
  let firstChapter;
  let lastChapter;
  switch (true) {
    case multipleChapters.test(userInput): {
      const [, matchedBook, matchedFirstChapter, matchedLastChapter] = userInput.match(multipleChapters);
      book = matchedBook.trim();
      firstChapter = Number(matchedFirstChapter);
      lastChapter = Number(matchedLastChapter);
      break;
    }
    default: {
      new import_obsidian.Notice(`Wrong format "${userInput}"`);
      throw "Could not parse user input";
    }
  }
  return { book, firstChapter, lastChapter };
}
function getFileByFilename(app, filename, path = "/") {
  let filenameCopy = filename;
  let tFile = app.metadataCache.getFirstLinkpathDest(filenameCopy, path);
  if (!tFile) {
    filenameCopy = tryConvertToOBSKFileName(filenameCopy);
    tFile = app.metadataCache.getFirstLinkpathDest(filenameCopy, path);
  }
  return { fileName: filenameCopy, tFile };
}
function tryConvertToOBSKFileName(bookAndChapter) {
  if (bookAndChapterRegexForOBSK.test(bookAndChapter)) {
    let [, book, number] = bookAndChapter.match(bookAndChapterRegexForOBSK);
    if (number.length == 1) {
      number = `0${number}`;
    }
    return `${book}-${number}`;
  }
}

// src/logic/copy-command.ts
function getTextOfVerses(app, userInput, settings, translationPath, linkOnly, verbose = true) {
  return __async(this, null, function* () {
    let { bookAndChapter, beginVerse, endVerse } = parseUserVerseInput(userInput, verbose);
    bookAndChapter = capitalize(bookAndChapter);
    const { fileName, tFile } = getFileByFilename(app, bookAndChapter, translationPath);
    if (tFile) {
      return yield createCopyOutput(app, tFile, fileName, beginVerse, endVerse, settings, translationPath, linkOnly, verbose);
    } else {
      if (verbose) {
        new import_obsidian2.Notice(`File ${bookAndChapter} not found`);
      }
      throw "File not found";
    }
  });
}
function getVerseText(verseNumber, headings, lines, keepNewlines, newLinePrefix) {
  if (verseNumber >= headings.length) {
    new import_obsidian2.Notice("Verse out of range for given file");
    throw `VerseNumber ${verseNumber} is out of range of headings with length ${headings.length}`;
  }
  const headingLine = headings[verseNumber].position.start.line;
  if (headingLine + 1 >= lines.length) {
    new import_obsidian2.Notice("Logical error - please create issue on plugin's GitHub with your input and the file you were referencing. Thank you!");
    throw `HeadingLine ${headingLine + 1} is out of range of lines with length ${lines}`;
  }
  let output = "";
  let line = "";
  let i = 1;
  let isFirst = true;
  while (true) {
    line = lines[headingLine + i];
    if (/^#/.test(line) || !line && !isFirst) {
      break;
    }
    i++;
    if (line) {
      if (!isFirst) {
        output += keepNewlines ? `
${newLinePrefix}` : " ";
      }
      isFirst = false;
      output += line;
    }
  }
  return output;
}
function replaceNewline(input) {
  return input.replace(/\\n/g, "\n");
}
function createBookAndChapterOutput(fileBasename) {
  if (isOBSKFile.test(fileBasename)) {
    let [, filename, chapter] = fileBasename.match(isOBSKFile);
    if (chapter.toString()[0] === "0") {
      chapter = chapter.substring(1);
    }
    return filename + " " + chapter;
  }
  return fileBasename;
}
function getFileFolderInTranslation(app, filename, translation) {
  const tFileInfo = getFileByFilename(app, filename, translation);
  return tFileInfo.tFile.parent.path;
}
function createCopyOutput(app, tFile, fileName, beginVerse, endVerse, settings, translationPath, linkOnly, verbose) {
  return __async(this, null, function* () {
    const bookAndChapterOutput = createBookAndChapterOutput(tFile.basename);
    const file = app.vault.read(tFile);
    const lines = (yield file).split(/\r?\n/);
    const verseHeadingLevel = settings.verseHeadingLevel;
    const headings = app.metadataCache.getFileCache(tFile).headings.filter((heading) => !verseHeadingLevel || heading.level === verseHeadingLevel);
    const beginVerseNoOffset = beginVerse;
    beginVerse += settings.verseOffset;
    endVerse += settings.verseOffset;
    var nrOfVerses = headings.length - 1;
    var maxVerse = endVerse < nrOfVerses ? endVerse : nrOfVerses;
    var maxVerseNoOffset = maxVerse - settings.verseOffset;
    if (beginVerse > maxVerse) {
      if (verbose) {
        new import_obsidian2.Notice("Begin verse is bigger than end verse or chapter maximum");
      }
      throw "Begin verse is bigger than end verse or chapter maximum";
    }
    let postfix = "", res = "", pathToUse = "";
    if (!linkOnly) {
      res = settings.prefix;
      postfix = settings.postfix ? replaceNewline(settings.postfix) : " ";
    }
    if (settings.enableMultipleTranslations) {
      if (settings.translationLinkingType !== "main")
        pathToUse = getFileFolderInTranslation(app, fileName, translationPath);
      else {
        pathToUse = getFileFolderInTranslation(app, fileName, settings.parsedTranslationPaths.first());
      }
    }
    if (beginVerse === maxVerse) {
      res += `[[${pathToUse ? pathToUse + "/" : ""}${fileName}#${headings[beginVerse].heading}|${bookAndChapterOutput}${settings.oneVerseNotation}${beginVerseNoOffset}]]${postfix}`;
    } else if (settings.linkEndVerse) {
      res += `[[${pathToUse ? pathToUse + "/" : ""}${fileName}#${headings[beginVerse].heading}|${bookAndChapterOutput}${settings.multipleVersesNotation}${beginVerseNoOffset}-]]`;
      res += `[[${pathToUse ? pathToUse + "/" : ""}${fileName}#${headings[maxVerse].heading}|${maxVerseNoOffset}]]${postfix}`;
    } else {
      res += `[[${pathToUse ? pathToUse + "/" : ""}${fileName}#${headings[beginVerse].heading}|${bookAndChapterOutput}${settings.multipleVersesNotation}${beginVerseNoOffset}-${maxVerseNoOffset}]]${postfix}`;
    }
    if (!linkOnly) {
      for (let i = beginVerse; i <= maxVerse; i++) {
        let versePrefix = "";
        const versePostfix = settings.insertSpace ? " " : "";
        if (settings.eachVersePrefix) {
          versePrefix += settings.eachVersePrefix.replace(/{n}/g, (i - settings.verseOffset).toString());
          versePrefix = versePrefix.replace(/{f}/g, `${fileName}`);
        }
        const verseText = getVerseText(i, headings, lines, settings.newLines, settings.prefix);
        if (settings.newLines) {
          res += "\n" + settings.prefix + versePrefix + verseText;
        } else {
          res += versePrefix + verseText + versePostfix;
        }
      }
    }
    if (!settings.useInvisibleLinks)
      return res;
    if (beginVerse == maxVerse && (!settings.enableMultipleTranslations || settings.translationLinkingType === "main" || settings.translationLinkingType === "used"))
      return res;
    if (settings.newLines && !linkOnly) {
      res += `
${settings.prefix}`;
    }
    const lastVerseToLink = settings.linkEndVerse ? maxVerse - 1 : maxVerse;
    for (let i = beginVerse + 1; i <= lastVerseToLink; i++) {
      if (!settings.enableMultipleTranslations) {
        res += `[[${fileName}#${headings[i].heading}|]]`;
      } else {
        let translationPathsToUse = [];
        switch (settings.translationLinkingType) {
          case "all":
            translationPathsToUse = settings.parsedTranslationPaths.map((tr) => getFileFolderInTranslation(app, fileName, tr));
            break;
          case "used":
            translationPathsToUse = [getFileFolderInTranslation(app, fileName, translationPath)];
            break;
          case "usedAndMain":
            if (translationPath !== settings.parsedTranslationPaths.first()) {
              translationPathsToUse = [
                getFileFolderInTranslation(app, fileName, translationPath),
                getFileFolderInTranslation(app, fileName, settings.parsedTranslationPaths.first())
              ];
            } else {
              translationPathsToUse = [getFileFolderInTranslation(app, fileName, translationPath)];
            }
            break;
          case "main":
            translationPathsToUse = [getFileFolderInTranslation(app, fileName, settings.parsedTranslationPaths.first())];
            break;
          default:
            break;
        }
        translationPathsToUse.forEach((translationPath2) => {
          res += `[[${translationPath2}/${fileName}#${headings[i].heading}|]]`;
        });
      }
    }
    return res;
  });
}

// src/modals/copy-verse-modal.ts
function setPreviewText(previewEl, userInput, pluginSettings, translationPath, linkOnly) {
  return __async(this, null, function* () {
    try {
      const res = yield getTextOfVerses(this.app, userInput, pluginSettings, translationPath, linkOnly, false);
      previewEl.setText(res);
    } catch (e) {
      previewEl.setText("");
      return;
    }
  });
}
var LinkType;
(function(LinkType3) {
  LinkType3["First"] = "First verse";
  LinkType3["FirstOtherInvis"] = "First verse + other invisible";
  LinkType3["FirstLast"] = "First and last verse";
  LinkType3["FirstLastOtherInvis"] = "First and last + other invisible";
  LinkType3["All"] = "All verses";
  LinkType3["AllInvis"] = "All verses, invisible";
})(LinkType || (LinkType = {}));
var CopyVerseModal = class extends import_obsidian3.Modal {
  constructor(app, settings, onSubmit) {
    super(app);
    this.handleInput = () => __async(this, null, function* () {
      try {
        const res = yield getTextOfVerses(this.app, this.userInput, this.pluginSettings, this.translationPath, this.linkOnly);
        this.close();
        this.onSubmit(res);
      } catch (err) {
        return;
      }
    });
    this.onSubmit = onSubmit;
    this.pluginSettings = settings;
  }
  onOpen() {
    const { contentEl } = this;
    let previewEl;
    const refreshPreview = () => {
      setPreviewText(previewEl, this.userInput, this.pluginSettings, this.translationPath, this.linkOnly);
    };
    contentEl.createEl("h3", { text: "Copy verse by bible reference" });
    new import_obsidian3.Setting(contentEl).setName("Insert reference").addText((text) => text.onChange((value) => {
      this.userInput = value;
      refreshPreview();
    }).inputEl.focus());
    if (this.pluginSettings.enableMultipleTranslations && this.pluginSettings.translationsPaths !== "") {
      const transationPicker = new import_obsidian3.Setting(contentEl).setName("Pick translation");
      let buttons = [];
      let buttonPathMap = new Map();
      this.pluginSettings.parsedTranslationPaths.forEach((path) => {
        transationPicker.addButton((btn) => {
          buttons.push(btn);
          buttonPathMap.set(btn, path);
          let splittedPath = path.split("/");
          btn.setButtonText(splittedPath[splittedPath.length - 2]);
        });
        buttons.forEach((btn) => {
          btn.onClick(() => {
            buttons.forEach((b) => b.removeCta());
            btn.setCta();
            this.translationPath = buttonPathMap.get(btn);
            refreshPreview();
          });
        });
        buttons.first().setCta();
        this.translationPath = buttonPathMap.get(buttons.first());
      });
    }
    this.linkOnly = this.pluginSettings.linkOnly;
    new import_obsidian3.Setting(contentEl).setName("Link only").addToggle((tgl) => {
      tgl.setValue(this.pluginSettings.linkOnly);
      tgl.onChange((val) => {
        this.linkOnly = val;
        refreshPreview();
      });
    });
    contentEl.createEl("label", { text: "Preview" });
    previewEl = contentEl.createEl("textarea", { cls: "copy-preview", attr: { readonly: true } });
    new import_obsidian3.Setting(contentEl).addButton((btn) => {
      btn.setButtonText("Link").setCta().onClick(this.handleInput);
    });
    contentEl.onkeydown = (event) => {
      if (event.key === "Enter") {
        event.preventDefault();
        this.handleInput();
      }
    };
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};

// src/modals/link-verse-modal.ts
var import_obsidian5 = __toModule(require("obsidian"));

// src/logic/link-command.ts
var import_obsidian4 = __toModule(require("obsidian"));
function createLinks(app, userInput, linkType, useNewLine, settings) {
  return __async(this, null, function* () {
    if (multipleChapters.test(userInput)) {
      return getLinksForChapters(app, userInput, linkType, useNewLine, settings);
    } else {
      return getLinksForVerses(app, userInput, linkType, useNewLine, settings);
    }
  });
}
function getLinksForVerses(app, userInput, linkType, useNewLine, settings) {
  return __async(this, null, function* () {
    let { bookAndChapter, beginVerse, endVerse } = parseUserVerseInput(userInput);
    bookAndChapter = capitalize(bookAndChapter);
    if (settings.verifyFilesWhenLinking) {
      const { fileName, tFile } = getFileByFilename(app, bookAndChapter);
      if (!tFile) {
        new import_obsidian4.Notice(`File "${fileName}" does not exist and verify files is set to true`);
        throw `File ${fileName} does not exist, verify files = true`;
      }
    }
    if (beginVerse > endVerse) {
      new import_obsidian4.Notice("Begin verse is bigger than end verse");
      throw "Begin verse is bigger than end verse";
    }
    let res = "";
    const beginning = linkType === LinkType2.Embedded ? "!" : "";
    const ending = linkType === LinkType2.Invisible ? "|" : "";
    for (let i = beginVerse; i <= endVerse; i++) {
      res += `${beginning}[[${bookAndChapter}${settings.linkSeparator}${settings.versePrefix}${i}${ending}]]`;
      if (useNewLine) {
        res += "\n";
      }
    }
    return res;
  });
}
function getLinksForChapters(app, userInput, linkType, useNewLine, settings) {
  return __async(this, null, function* () {
    const { book, firstChapter, lastChapter } = parseUserBookInput(userInput);
    if (firstChapter > lastChapter) {
      new import_obsidian4.Notice("Begin chapter is bigger than end chapter");
      throw "Begin chapter is bigger than end chapter";
    }
    let res = "";
    for (let i = firstChapter; i <= lastChapter; i++) {
      res += `[[${book} ${i}]]`;
      if (useNewLine) {
        res += "\n";
      }
    }
    return res;
  });
}

// src/modals/link-verse-modal.ts
var LinkType2;
(function(LinkType3) {
  LinkType3["Basic"] = "Basic";
  LinkType3["Embedded"] = "Embedded";
  LinkType3["Invisible"] = "Invisible";
})(LinkType2 || (LinkType2 = {}));
var LinkVerseModal = class extends import_obsidian5.Modal {
  constructor(app, settings, onSubmit) {
    super(app);
    this.handleInput = () => __async(this, null, function* () {
      try {
        const res = yield createLinks(this.app, this.userInput, this.linkType, this.useNewLine, this.pluginSettings);
        this.close();
        this.onSubmit(res);
      } catch (err) {
        return;
      }
    });
    this.onSubmit = onSubmit;
    this.pluginSettings = settings;
    this.linkType = this.pluginSettings.linkTypePreset;
    this.useNewLine = this.pluginSettings.newLinePreset;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.createEl("h3", { text: "Create Obsidian links from Bible reference" });
    new import_obsidian5.Setting(contentEl).setName("Insert reference").addText((text) => text.onChange((value) => {
      this.userInput = value;
    }).inputEl.focus());
    new import_obsidian5.Setting(contentEl).setName("Link type").addDropdown((dropdown) => {
      dropdown.addOption(LinkType2.Basic, LinkType2.Basic);
      dropdown.addOption(LinkType2.Embedded, LinkType2.Embedded);
      dropdown.addOption(LinkType2.Invisible, LinkType2.Invisible);
      dropdown.onChange((value) => this.linkType = value);
      dropdown.setValue(this.pluginSettings.linkTypePreset);
    });
    new import_obsidian5.Setting(contentEl).setName("Each link on new line?").addToggle((tgl) => {
      tgl.setValue(this.pluginSettings.newLinePreset);
      tgl.onChange((val) => {
        this.useNewLine = val;
      });
    });
    new import_obsidian5.Setting(contentEl).addButton((btn) => {
      btn.setButtonText("Link").setCta().onClick(this.handleInput);
    });
    contentEl.onkeydown = (event) => {
      if (event.key === "Enter") {
        event.preventDefault();
        this.handleInput();
      }
    };
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};

// src/settings.ts
var import_obsidian6 = __toModule(require("obsidian"));
var SettingsTab = class extends import_obsidian6.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Copy and Link Bible verses command" });
    containerEl.createEl("h4", { text: "Functional" });
    new import_obsidian6.Setting(containerEl).setName("Verse offset").setDesc('Change this if wrong verses are being linked, e.g. you want "Gen 1,1-3" but output is text from verses 2-4 \u2192 set this to -1').setClass("important-setting").addText((inputBox) => inputBox.setValue(this.plugin.settings.verseOffset.toString()).onChange((value) => __async(this, null, function* () {
      const number = Number.parseInt(value);
      if (value === "-")
        return;
      if (Number.isNaN(number)) {
        new import_obsidian6.Notice("Invalid input, please insert valid integer");
        inputBox.setValue("");
        return;
      }
      this.plugin.settings.verseOffset = number;
      yield this.plugin.saveSettings();
    })));
    new import_obsidian6.Setting(containerEl).setName("Verse heading level").setDesc('If set, only headings of specified level are considered verses (if first heading of this level is always a verse, also set "Verse offset" to -1)').addDropdown((dropdown) => {
      var _a, _b;
      dropdown.addOption("any", "any");
      dropdown.addOption("6", "######");
      dropdown.addOption("5", "#####");
      dropdown.addOption("4", "####");
      dropdown.addOption("3", "###");
      dropdown.addOption("2", "##");
      dropdown.addOption("1", "#");
      dropdown.setValue((_b = (_a = this.plugin.settings.verseHeadingLevel) == null ? void 0 : _a.toString()) != null ? _b : "any");
      dropdown.onChange((value) => __async(this, null, function* () {
        this.plugin.settings.verseHeadingLevel = value === "any" ? void 0 : Number(value);
        yield this.plugin.saveSettings();
      }));
    });
    containerEl.createEl("h4", { text: "Inserted prefixes/postfixes" });
    new import_obsidian6.Setting(containerEl).setName("Line prefix").setDesc("String inserted in front of every line, for example '>' for quote. Note: If you set 'Put each verse on a new line?' to true, the prefix will be inserted in front of every line.").setClass("important-setting").addText((inputBox) => inputBox.setPlaceholder("Insert prefix here").setValue(this.plugin.settings.prefix).onChange((value) => __async(this, null, function* () {
      this.plugin.settings.prefix = value;
      yield this.plugin.saveSettings();
    })));
    new import_obsidian6.Setting(containerEl).setName("Link postfix").setDesc("String inserted after biblical link, you can use \\n to insert newline.").addText((inputBox) => inputBox.setPlaceholder("Insert postfix here").setValue(this.plugin.settings.postfix).onChange((value) => __async(this, null, function* () {
      this.plugin.settings.postfix = value;
      yield this.plugin.saveSettings();
    })));
    new import_obsidian6.Setting(containerEl).setName("Each verse prefix").setDesc('String inserted in front of every copied verse. You can use "{n}" where you want number of given verse inserted, for example "**{n}** " will make each verse start with bold verse number. You can also use "{f}" to insert name of the corresponding file (for example to create obsidian links). Leave empty for no prefix.').addText((inputBox) => inputBox.setPlaceholder("Insert prefix here").setValue(this.plugin.settings.eachVersePrefix).onChange((value) => __async(this, null, function* () {
      this.plugin.settings.eachVersePrefix = value;
      yield this.plugin.saveSettings();
    })));
    containerEl.createEl("h4", { text: "Links" });
    new import_obsidian6.Setting(containerEl).setName("Link to last verse?").setDesc("Should last verse be linked in the visible link before text of verses?").addToggle((toggle) => toggle.setValue(this.plugin.settings.linkEndVerse).onChange((value) => __async(this, null, function* () {
      this.plugin.settings.linkEndVerse = value;
      yield this.plugin.saveSettings();
    })));
    new import_obsidian6.Setting(containerEl).setName("Add invisible links?").setDesc("Invisible links are added to each verse used (so you can find the connections later), they are only visible in source mode.").addToggle((toggle) => toggle.setValue(this.plugin.settings.useInvisibleLinks).onChange((value) => __async(this, null, function* () {
      this.plugin.settings.useInvisibleLinks = value;
      yield this.plugin.saveSettings();
    })));
    new import_obsidian6.Setting(containerEl).setName("Link only default").setDesc("What the link only option should be set to by default").addToggle((toggle) => toggle.setValue(this.plugin.settings.linkOnly).onChange((value) => __async(this, null, function* () {
      this.plugin.settings.linkOnly = value;
      yield this.plugin.saveSettings();
    })));
    containerEl.createEl("h4", { text: "Output format" });
    new import_obsidian6.Setting(containerEl).setName("Put each verse on a new line?").setDesc("Each verse is inserted on a new line (with Link prefix).").addToggle((toggle) => toggle.setValue(this.plugin.settings.newLines).onChange((value) => __async(this, null, function* () {
      this.plugin.settings.newLines = value;
      yield this.plugin.saveSettings();
    })));
    new import_obsidian6.Setting(containerEl).setName("Insert space between verses?").setDesc("Should space be inserted between verses? (Only applied when Put each verse on a new line? is se to false. Useful for languages such as Chinese.)").setDisabled(!this.plugin.settings.newLines).addToggle((toggle) => toggle.setValue(this.plugin.settings.insertSpace).onChange((value) => __async(this, null, function* () {
      this.plugin.settings.insertSpace = value;
      yield this.plugin.saveSettings();
    })));
    containerEl.createEl("h4", { text: "Notation" });
    new import_obsidian6.Setting(containerEl).setName("One verse notation").setDesc('This is the symbol that will be used between chapter number and verse number when copying one verse. For example "." \u2192 Gen 1.1.').addText((inputBox) => inputBox.setPlaceholder("Insert notation symbol here").setValue(this.plugin.settings.oneVerseNotation).onChange((value) => __async(this, null, function* () {
      this.plugin.settings.oneVerseNotation = value;
      yield this.plugin.saveSettings();
    })));
    new import_obsidian6.Setting(containerEl).setName("Multiple verses notation").setDesc('This is the symbol that will be used between chapter number and verse number when copying multiple verses. For example "," \u2192 Gen 1,1-3.').addText((inputBox) => inputBox.setPlaceholder("Insert notation symbol here").setValue(this.plugin.settings.multipleVersesNotation).onChange((value) => __async(this, null, function* () {
      this.plugin.settings.multipleVersesNotation = value;
      yield this.plugin.saveSettings();
    })));
    containerEl.createEl("h4", { text: "Multiple translations" });
    new import_obsidian6.Setting(containerEl).setName("Enable multiple translations").addToggle((toggle) => toggle.setValue(this.plugin.settings.enableMultipleTranslations).onChange((value) => __async(this, null, function* () {
      this.plugin.settings.enableMultipleTranslations = value;
      yield this.plugin.saveSettings();
      this.display();
    })));
    if (this.plugin.settings.enableMultipleTranslations) {
      new import_obsidian6.Setting(containerEl).setName("Paths to translations with their names").setDesc('Input full paths from the root valut folder to folders containing Bible translations, each trnaslation on separate line. An example of one entry: "Bible/NIV/". The plugin will search for corresponding Bible files using given paths as starting points. Make sure there are no duplicate files in given paths, otherwise it is hard to tell what the output will be. The first translation will be considered your main translation.').addTextArea((inputBox) => inputBox.setPlaceholder("Bible/NIV/\nBible/ESV/").setValue(this.plugin.settings.translationsPaths).onChange((value) => __async(this, null, function* () {
        const inputPaths = value.split(/\r?\n|\r/);
        const paths = [];
        inputPaths.forEach((path) => {
          if (path.at(-1) !== "/") {
            paths.push(path + "/");
          } else {
            paths.push(path);
          }
        });
        this.plugin.settings.translationsPaths = value;
        this.plugin.settings.parsedTranslationPaths = paths;
        yield this.plugin.saveSettings();
      })));
      new import_obsidian6.Setting(containerEl).setName("What to link").setDesc("Choose what translations should be linked when copying a verse.").addDropdown((dropdown) => {
        dropdown.addOption("all", "Link to all translations");
        dropdown.addOption("used", "Link only to used translation");
        dropdown.addOption("usedAndMain", "Link to used and main translation");
        dropdown.addOption("main", "Link only to main translation");
        dropdown.setValue(this.plugin.settings.translationLinkingType);
        dropdown.onChange((value) => __async(this, null, function* () {
          this.plugin.settings.translationLinkingType = value;
          yield this.plugin.saveSettings();
        }));
      });
    }
    containerEl.createEl("h2", { text: "Link Bible verses command" });
    containerEl.createEl("h4", { text: "File format" });
    new import_obsidian6.Setting(containerEl).setName("Link separator").setDesc("This is the separator that will be used when linking, e.g. if you enter '#' here, output will be [[Gen 1#1]]. If you are using headings to mark verses, use '#'. If you are using block references, use '^'.").setClass("important-setting").addText((inputBox) => inputBox.setPlaceholder("Insert separator here").setValue(this.plugin.settings.linkSeparator).onChange((value) => __async(this, null, function* () {
      this.plugin.settings.linkSeparator = value;
      yield this.plugin.saveSettings();
    })));
    new import_obsidian6.Setting(containerEl).setName("Verse prefix").setDesc('Fill this if you are using verse prefixes in your bible files, e.g. you have "v1" in your file \u2192 set to "v".').setClass("important-setting").addText((inputBox) => inputBox.setPlaceholder("Insert prefix here").setValue(this.plugin.settings.versePrefix).onChange((value) => __async(this, null, function* () {
      this.plugin.settings.versePrefix = value;
      yield this.plugin.saveSettings();
    })));
    containerEl.createEl("h4", { text: "Defaults" });
    new import_obsidian6.Setting(containerEl).setName("Link type default value").setDesc("Value that will be selected by default in link modal.").addDropdown((dropdown) => {
      dropdown.addOption(LinkType2.Basic, LinkType2.Basic);
      dropdown.addOption(LinkType2.Embedded, LinkType2.Embedded);
      dropdown.addOption(LinkType2.Invisible, LinkType2.Invisible);
      dropdown.setValue(this.plugin.settings.linkTypePreset);
      dropdown.onChange((value) => __async(this, null, function* () {
        this.plugin.settings.linkTypePreset = value;
        yield this.plugin.saveSettings();
      }));
    });
    new import_obsidian6.Setting(containerEl).setName("Use new lines default value").setDesc("Value that will be selected by default in link modal.").addToggle((toggle) => toggle.setValue(this.plugin.settings.newLinePreset).onChange((value) => __async(this, null, function* () {
      this.plugin.settings.newLinePreset = value;
      yield this.plugin.saveSettings();
    })));
    containerEl.createEl("h4", { text: "Misc" });
    new import_obsidian6.Setting(containerEl).setName("Verify files?").setDesc("Verify existence of files you are trying to link, so that you are not inserting wrong references by mistake.").addToggle((toggle) => toggle.setValue(this.plugin.settings.verifyFilesWhenLinking).onChange((value) => __async(this, null, function* () {
      this.plugin.settings.verifyFilesWhenLinking = value;
      yield this.plugin.saveSettings();
    })));
  }
};

// src/main.ts
var DEFAULT_SETTINGS = {
  verseOffset: 0,
  verseHeadingLevel: void 0,
  prefix: "",
  postfix: "",
  eachVersePrefix: "",
  linkEndVerse: false,
  useInvisibleLinks: true,
  linkOnly: false,
  newLines: false,
  insertSpace: true,
  oneVerseNotation: ".",
  multipleVersesNotation: ",",
  enableMultipleTranslations: false,
  translationsPaths: "",
  parsedTranslationPaths: [],
  translationLinkingType: "all",
  linkSeparator: "#",
  versePrefix: "",
  linkTypePreset: LinkType2.Basic,
  newLinePreset: true,
  verifyFilesWhenLinking: false
};
var BibleLinkerPlugin = class extends import_obsidian7.Plugin {
  constructor() {
    super(...arguments);
    this.openCopyModal = () => {
      const view = this.app.workspace.getActiveViewOfType(import_obsidian7.MarkdownView);
      if (view) {
        new CopyVerseModal(this.app, this.settings, (str) => view.editor.replaceRange(str, view.editor.getCursor())).open();
      }
    };
    this.openObsidianLinkModal = () => {
      const view = this.app.workspace.getActiveViewOfType(import_obsidian7.MarkdownView);
      if (view) {
        new LinkVerseModal(this.app, this.settings, (str) => view.editor.replaceRange(str, view.editor.getCursor())).open();
      }
    };
  }
  loadSettings() {
    return __async(this, null, function* () {
      this.settings = Object.assign({}, DEFAULT_SETTINGS, yield this.loadData());
    });
  }
  saveSettings() {
    return __async(this, null, function* () {
      yield this.saveData(this.settings);
    });
  }
  onload() {
    return __async(this, null, function* () {
      yield this.loadSettings();
      this.addSettingTab(new SettingsTab(this.app, this));
      this.addCommand({
        id: "insert-bible-link",
        name: "Copy and Link Bible verses",
        icon: "copy",
        editorCallback: this.openCopyModal
      });
      this.addCommand({
        id: "insert-bible-link-obsidian-link",
        name: "Link Bible verses",
        icon: "link",
        editorCallback: this.openObsidianLinkModal
      });
    });
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL21vZGFscy9jb3B5LXZlcnNlLW1vZGFsLnRzIiwgInNyYy9sb2dpYy9jb3B5LWNvbW1hbmQudHMiLCAic3JjL3V0aWxzL3JlZ2V4ZXMudHMiLCAic3JjL2xvZ2ljL2NvbW1vbi50cyIsICJzcmMvbW9kYWxzL2xpbmstdmVyc2UtbW9kYWwudHMiLCAic3JjL2xvZ2ljL2xpbmstY29tbWFuZC50cyIsICJzcmMvc2V0dGluZ3MudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7IE1hcmtkb3duVmlldywgUGx1Z2luIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgQ29weVZlcnNlTW9kYWwsIHsgTGlua1R5cGUgYXMgQ29weUxpbmtUeXBlIH0gZnJvbSAnc3JjL21vZGFscy9jb3B5LXZlcnNlLW1vZGFsJztcclxuaW1wb3J0IExpbmtWZXJzZU1vZGFsLCB7IExpbmtUeXBlIH0gZnJvbSAnLi9tb2RhbHMvbGluay12ZXJzZS1tb2RhbCc7XHJcbmltcG9ydCB7IFNldHRpbmdzVGFiIH0gZnJvbSAnLi9zZXR0aW5ncyc7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFBsdWdpblNldHRpbmdzIHtcclxuICAgIC8vIENPUFlcclxuICAgIC8vIEZ1bmN0aW9uYWxcclxuICAgIHZlcnNlT2Zmc2V0OiBudW1iZXI7XHJcbiAgICB2ZXJzZUhlYWRpbmdMZXZlbD86IG51bWJlcjtcclxuXHJcbiAgICAvLyBJbnNlcnRlZCBwcmVmaXhlcy9wb3N0Zml4ZXNcclxuICAgIHByZWZpeDogc3RyaW5nO1xyXG4gICAgcG9zdGZpeDogc3RyaW5nO1xyXG4gICAgZWFjaFZlcnNlUHJlZml4OiBzdHJpbmc7XHJcblxyXG4gICAgLy8gTGlua3NcclxuICAgIGxpbmtFbmRWZXJzZTogYm9vbGVhbjtcclxuICAgIHVzZUludmlzaWJsZUxpbmtzOiBib29sZWFuO1xyXG4gICAgbGlua09ubHk6IGJvb2xlYW47XHJcblxyXG4gICAgLy8gT3V0cHV0IGZvcm1hdFxyXG4gICAgbmV3TGluZXM6IGJvb2xlYW47XHJcbiAgICBpbnNlcnRTcGFjZTogYm9vbGVhbjtcclxuXHJcbiAgICAvLyBOb3RhdGlvblxyXG4gICAgb25lVmVyc2VOb3RhdGlvbjogc3RyaW5nO1xyXG4gICAgbXVsdGlwbGVWZXJzZXNOb3RhdGlvbjogc3RyaW5nO1xyXG5cclxuICAgIC8vIE11bHRpcGxlIHRyYW5zbGF0aW9uc1xyXG4gICAgZW5hYmxlTXVsdGlwbGVUcmFuc2xhdGlvbnM6IGJvb2xlYW47XHJcbiAgICB0cmFuc2xhdGlvbnNQYXRoczogc3RyaW5nO1xyXG4gICAgcGFyc2VkVHJhbnNsYXRpb25QYXRoczogc3RyaW5nW107IC8vIGNhbGxjdWxhdGVkIGZyb20gdHJhbnNsYXRpb25zIHBhdGhzLCBub3Qgc2hvd24gdG8gdGhlIHVzZXJcclxuICAgIHRyYW5zbGF0aW9uTGlua2luZ1R5cGU6IHN0cmluZztcclxuXHJcbiAgICAvLyBMSU5LXHJcbiAgICAvLyBGaWxlIGZvcm1hdFxyXG4gICAgbGlua1NlcGFyYXRvcjogc3RyaW5nO1xyXG4gICAgdmVyc2VQcmVmaXg6IHN0cmluZztcclxuXHJcbiAgICAvLyBEZWZhdWx0c1xyXG4gICAgbGlua1R5cGVQcmVzZXQ6IExpbmtUeXBlO1xyXG4gICAgbmV3TGluZVByZXNldDogYm9vbGVhbjtcclxuXHJcbiAgICAvLyBNaXNjXHJcbiAgICB2ZXJpZnlGaWxlc1doZW5MaW5raW5nOiBib29sZWFuO1xyXG59XHJcblxyXG5jb25zdCBERUZBVUxUX1NFVFRJTkdTOiBQYXJ0aWFsPFBsdWdpblNldHRpbmdzPiA9IHtcclxuICAgIC8vIENPUFlcclxuICAgIC8vIEZ1bmN0aW9uYWxcclxuICAgIHZlcnNlT2Zmc2V0OiAwLFxyXG4gICAgdmVyc2VIZWFkaW5nTGV2ZWw6IHVuZGVmaW5lZCxcclxuXHJcbiAgICAvLyBJbnNlcnRlZCBwcmVmaXhlcy9wb3N0Zml4ZXNcclxuICAgIHByZWZpeDogXCJcIixcclxuICAgIHBvc3RmaXg6IFwiXCIsXHJcbiAgICBlYWNoVmVyc2VQcmVmaXg6IFwiXCIsXHJcblxyXG4gICAgLy8gTGlua3NcclxuICAgIGxpbmtFbmRWZXJzZTogZmFsc2UsXHJcbiAgICB1c2VJbnZpc2libGVMaW5rczogdHJ1ZSxcclxuICAgIGxpbmtPbmx5OiBmYWxzZSxcclxuXHJcbiAgICAvLyBPdXRwdXQgZm9ybWF0XHJcbiAgICBuZXdMaW5lczogZmFsc2UsXHJcbiAgICBpbnNlcnRTcGFjZTogdHJ1ZSxcclxuXHJcbiAgICAvLyBOb3RhdGlvblxyXG4gICAgb25lVmVyc2VOb3RhdGlvbjogXCIuXCIsXHJcbiAgICBtdWx0aXBsZVZlcnNlc05vdGF0aW9uOiBcIixcIixcclxuXHJcbiAgICAvLyBNdWx0aXBsZSB0cmFuc2xhdGlvbnNcclxuICAgIGVuYWJsZU11bHRpcGxlVHJhbnNsYXRpb25zOiBmYWxzZSxcclxuICAgIHRyYW5zbGF0aW9uc1BhdGhzOiBcIlwiLFxyXG4gICAgcGFyc2VkVHJhbnNsYXRpb25QYXRoczogW10sXHJcbiAgICB0cmFuc2xhdGlvbkxpbmtpbmdUeXBlOiBcImFsbFwiLFxyXG5cclxuICAgIC8vIExJTktcclxuICAgIC8vIEZpbGUgZm9ybWF0XHJcbiAgICBsaW5rU2VwYXJhdG9yOiBcIiNcIixcclxuICAgIHZlcnNlUHJlZml4OiBcIlwiLFxyXG5cclxuICAgIC8vIERlZmF1bHRzXHJcbiAgICBsaW5rVHlwZVByZXNldDogTGlua1R5cGUuQmFzaWMsXHJcbiAgICBuZXdMaW5lUHJlc2V0OiB0cnVlLFxyXG5cclxuICAgIC8vIE1pc2NcclxuICAgIHZlcmlmeUZpbGVzV2hlbkxpbmtpbmc6IGZhbHNlLFxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBCaWJsZUxpbmtlclBsdWdpbiBleHRlbmRzIFBsdWdpbiB7XHJcbiAgICBzZXR0aW5nczogUGx1Z2luU2V0dGluZ3M7XHJcblxyXG4gICAgLy8gT3BlbnMgbW9kYWwgZm9yIHRleHQgY29weWluZ1xyXG4gICAgb3BlbkNvcHlNb2RhbCA9ICgpID0+IHtcclxuICAgICAgICBjb25zdCB2aWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcclxuICAgICAgICBpZiAodmlldykge1xyXG4gICAgICAgICAgICBuZXcgQ29weVZlcnNlTW9kYWwodGhpcy5hcHAsIHRoaXMuc2V0dGluZ3MsXHJcbiAgICAgICAgICAgICAgICAoc3RyKSA9PiB2aWV3LmVkaXRvci5yZXBsYWNlUmFuZ2Uoc3RyLCB2aWV3LmVkaXRvci5nZXRDdXJzb3IoKSkpLm9wZW4oKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gT3BlbnMgbW9kYWwgZm9yIGNyZWF0aW5nIG9ic2lkaWFuIGxpbmtzXHJcbiAgICBvcGVuT2JzaWRpYW5MaW5rTW9kYWwgPSAoKSA9PiB7XHJcbiAgICAgICAgY29uc3QgdmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XHJcbiAgICAgICAgaWYgKHZpZXcpIHtcclxuICAgICAgICAgICAgbmV3IExpbmtWZXJzZU1vZGFsKHRoaXMuYXBwLCB0aGlzLnNldHRpbmdzLFxyXG4gICAgICAgICAgICAgICAgKHN0cikgPT4gdmlldy5lZGl0b3IucmVwbGFjZVJhbmdlKHN0ciwgdmlldy5lZGl0b3IuZ2V0Q3Vyc29yKCkpKS5vcGVuKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBhc3luYyBsb2FkU2V0dGluZ3MoKSB7XHJcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MsIGF3YWl0IHRoaXMubG9hZERhdGEoKSlcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBzYXZlU2V0dGluZ3MoKSB7XHJcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKVxyXG4gICAgfVxyXG5cclxuICAgIC8vIFJ1biBvbmNlIHdoZW4gcGx1Z2luIGlzIGxvYWRlZFxyXG4gICAgYXN5bmMgb25sb2FkKCkge1xyXG4gICAgICAgIC8vIEhhbmRsZSBzZXR0aW5nc1xyXG4gICAgICAgIGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XHJcbiAgICAgICAgdGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBTZXR0aW5nc1RhYih0aGlzLmFwcCwgdGhpcykpXHJcblxyXG4gICAgICAgIC8vIEFkZCBpY29uIHRvIGluc2VydCBsaW5rIFxyXG4gICAgICAgIC8vIHRoaXMuYWRkUmliYm9uSWNvbihcImxpbmtcIiwgXCJJbnNlcnQgYmlibGUgbGlua1wiLCAoZXZ0OiBNb3VzZUV2ZW50KSA9PiB0aGlzLm9wZW5Db3B5TW9kYWwoKSk7XHJcblxyXG4gICAgICAgIC8vIENvbW1hbmQgdG8gaW5zZXJ0IGxpbmsgKG9ubHkgYXZhaWxhYmxlIGluIGVkaXRvciBtb2RlKVxyXG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XHJcbiAgICAgICAgICAgIGlkOiAnaW5zZXJ0LWJpYmxlLWxpbmsnLCAvLyBJRCBsZWZ0IHRvIHByZXNlcnZlIHVzZXIncyBrZXkgbWFwcGluZ3NcclxuICAgICAgICAgICAgbmFtZTogXCJDb3B5IGFuZCBMaW5rIEJpYmxlIHZlcnNlc1wiLFxyXG4gICAgICAgICAgICBpY29uOiBcImNvcHlcIixcclxuICAgICAgICAgICAgZWRpdG9yQ2FsbGJhY2s6IHRoaXMub3BlbkNvcHlNb2RhbFxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIC8vIENvbW1hbmQgdG8gaW5zZXJ0IGxpbmsgKG9ubHkgYXZhaWxhYmxlIGluIGVkaXRvciBtb2RlKVxyXG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XHJcbiAgICAgICAgICAgIGlkOiAnaW5zZXJ0LWJpYmxlLWxpbmstb2JzaWRpYW4tbGluaycsXHJcbiAgICAgICAgICAgIG5hbWU6IFwiTGluayBCaWJsZSB2ZXJzZXNcIixcclxuICAgICAgICAgICAgaWNvbjogXCJsaW5rXCIsXHJcbiAgICAgICAgICAgIGVkaXRvckNhbGxiYWNrOiB0aGlzLm9wZW5PYnNpZGlhbkxpbmtNb2RhbFxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcbn1cclxuIiwgImltcG9ydCB7IEFwcCwgQnV0dG9uQ29tcG9uZW50LCBNb2RhbCwgU2V0dGluZyB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgeyBQbHVnaW5TZXR0aW5ncyB9IGZyb20gXCIuLi9tYWluXCI7XHJcbmltcG9ydCB7IGdldFRleHRPZlZlcnNlcyB9IGZyb20gXCIuLi9sb2dpYy9jb3B5LWNvbW1hbmRcIjtcclxuXHJcbi8qKlxyXG4gKiBBc3luYyBmdW5jdGlvbiBmb3IgZmV0Y2hpbmcgcHJldmlldyBcclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIHNldFByZXZpZXdUZXh0KHByZXZpZXdFbDogSFRNTFRleHRBcmVhRWxlbWVudCwgdXNlcklucHV0OiBzdHJpbmcsIHBsdWdpblNldHRpbmdzOiBQbHVnaW5TZXR0aW5ncywgdHJhbnNsYXRpb25QYXRoOiBzdHJpbmcsIGxpbmtPbmx5OiBib29sZWFuKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGdldFRleHRPZlZlcnNlcyh0aGlzLmFwcCwgdXNlcklucHV0LCBwbHVnaW5TZXR0aW5ncywgdHJhbnNsYXRpb25QYXRoLCBsaW5rT25seSwgZmFsc2UpO1xyXG4gICAgICAgIHByZXZpZXdFbC5zZXRUZXh0KHJlcyk7XHJcbiAgICB9XHJcbiAgICBjYXRjaCB7XHJcbiAgICAgICAgcHJldmlld0VsLnNldFRleHQoXCJcIik7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZW51bSBMaW5rVHlwZSB7XHJcbiAgICBGaXJzdCA9IFwiRmlyc3QgdmVyc2VcIixcclxuICAgIEZpcnN0T3RoZXJJbnZpcyA9IFwiRmlyc3QgdmVyc2UgKyBvdGhlciBpbnZpc2libGVcIixcclxuICAgIEZpcnN0TGFzdCA9IFwiRmlyc3QgYW5kIGxhc3QgdmVyc2VcIixcclxuICAgIEZpcnN0TGFzdE90aGVySW52aXMgPSBcIkZpcnN0IGFuZCBsYXN0ICsgb3RoZXIgaW52aXNpYmxlXCIsXHJcbiAgICBBbGwgPSBcIkFsbCB2ZXJzZXNcIixcclxuICAgIEFsbEludmlzID0gXCJBbGwgdmVyc2VzLCBpbnZpc2libGVcIixcclxufVxyXG5cclxuLyoqXHJcbiAqIE1vZGFsIHRoYXQgbGV0cyB5b3UgaW5zZXJ0IGJpYmxlIHJlZmVyZW5jZSBieSBjb3B5aW5nIHRleHQgb2YgZ2l2ZW4gdmVyc2VzXHJcbiAqL1xyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDb3B5VmVyc2VNb2RhbCBleHRlbmRzIE1vZGFsIHtcclxuICAgIHVzZXJJbnB1dDogc3RyaW5nXHJcbiAgICBvblN1Ym1pdDogKHJlc3VsdDogc3RyaW5nKSA9PiB2b2lkXHJcbiAgICBwbHVnaW5TZXR0aW5nczogUGx1Z2luU2V0dGluZ3M7XHJcbiAgICB0cmFuc2xhdGlvblBhdGg6IHN0cmluZztcclxuICAgIGxpbmtPbmx5OiBib29sZWFuO1xyXG5cclxuICAgIGhhbmRsZUlucHV0ID0gYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGdldFRleHRPZlZlcnNlcyh0aGlzLmFwcCwgdGhpcy51c2VySW5wdXQsIHRoaXMucGx1Z2luU2V0dGluZ3MsIHRoaXMudHJhbnNsYXRpb25QYXRoLCB0aGlzLmxpbmtPbmx5KTtcclxuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgICAgICB0aGlzLm9uU3VibWl0KHJlcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgc2V0dGluZ3M6IFBsdWdpblNldHRpbmdzLCBvblN1Ym1pdDogKHJlc3VsdDogc3RyaW5nKSA9PiB2b2lkKSB7XHJcbiAgICAgICAgc3VwZXIoYXBwKTtcclxuICAgICAgICB0aGlzLm9uU3VibWl0ID0gb25TdWJtaXQ7XHJcbiAgICAgICAgdGhpcy5wbHVnaW5TZXR0aW5ncyA9IHNldHRpbmdzO1xyXG4gICAgfVxyXG5cclxuXHJcblxyXG4gICAgb25PcGVuKCkge1xyXG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xyXG4gICAgICAgIGxldCBwcmV2aWV3RWw6IEhUTUxUZXh0QXJlYUVsZW1lbnQ7XHJcblxyXG4gICAgICAgIGNvbnN0IHJlZnJlc2hQcmV2aWV3ID0gKCkgPT4ge1xyXG4gICAgICAgICAgICBzZXRQcmV2aWV3VGV4dChwcmV2aWV3RWwsIHRoaXMudXNlcklucHV0LCB0aGlzLnBsdWdpblNldHRpbmdzLCB0aGlzLnRyYW5zbGF0aW9uUGF0aCwgdGhpcy5saW5rT25seSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBBZGQgaGVhZGluZyBcclxuICAgICAgICBjb250ZW50RWwuY3JlYXRlRWwoXCJoM1wiLCB7IHRleHQ6IFwiQ29weSB2ZXJzZSBieSBiaWJsZSByZWZlcmVuY2VcIiB9KTtcclxuXHJcbiAgICAgICAgLy8gQWRkIFRleHRib3ggZm9yIHJlZmVyZW5jZVxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoXCJJbnNlcnQgcmVmZXJlbmNlXCIpXHJcbiAgICAgICAgICAgIC5hZGRUZXh0KCh0ZXh0KSA9PiB0ZXh0Lm9uQ2hhbmdlKCh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy51c2VySW5wdXQgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgIHJlZnJlc2hQcmV2aWV3KCk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAuaW5wdXRFbC5mb2N1cygpKTsgLy8gU2V0cyBmb2N1cyB0byBpbnB1dCBmaWVsZFxyXG5cclxuICAgICAgICAvLyBBZGQgdHJhbnNsYXRpb24gcGlja2VyXHJcbiAgICAgICAgaWYgKHRoaXMucGx1Z2luU2V0dGluZ3MuZW5hYmxlTXVsdGlwbGVUcmFuc2xhdGlvbnMgJiYgdGhpcy5wbHVnaW5TZXR0aW5ncy50cmFuc2xhdGlvbnNQYXRocyAhPT0gXCJcIikge1xyXG4gICAgICAgICAgICBjb25zdCB0cmFuc2F0aW9uUGlja2VyID0gbmV3IFNldHRpbmcoY29udGVudEVsKVxyXG4gICAgICAgICAgICAgICAgLnNldE5hbWUoXCJQaWNrIHRyYW5zbGF0aW9uXCIpXHJcblxyXG4gICAgICAgICAgICBsZXQgYnV0dG9uczogQnV0dG9uQ29tcG9uZW50W10gPSBbXTtcclxuICAgICAgICAgICAgbGV0IGJ1dHRvblBhdGhNYXAgPSBuZXcgTWFwPEJ1dHRvbkNvbXBvbmVudCwgc3RyaW5nPigpO1xyXG5cclxuXHJcbiAgICAgICAgICAgIHRoaXMucGx1Z2luU2V0dGluZ3MucGFyc2VkVHJhbnNsYXRpb25QYXRocy5mb3JFYWNoKChwYXRoKSA9PiB7IC8vIGRpc3BsYXkgdHJhbnNsYXRpb24gYnV0dG9uc1xyXG4gICAgICAgICAgICAgICAgdHJhbnNhdGlvblBpY2tlclxyXG4gICAgICAgICAgICAgICAgICAgIC5hZGRCdXR0b24oKGJ0bikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBidXR0b25zLnB1c2goYnRuKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uUGF0aE1hcC5zZXQoYnRuLCBwYXRoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHNwbGl0dGVkUGF0aCA9IHBhdGguc3BsaXQoXCIvXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBidG4uc2V0QnV0dG9uVGV4dChzcGxpdHRlZFBhdGhbc3BsaXR0ZWRQYXRoLmxlbmd0aCAtIDJdKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG5cclxuICAgICAgICAgICAgICAgIGJ1dHRvbnMuZm9yRWFjaCgoYnRuKSA9PiB7IC8vIG1ha2Ugc3VyZSB0aGF0IG9ubHkgb25lIGlzIHNlbGVjdGVkIGF0IGEgdGltZVxyXG4gICAgICAgICAgICAgICAgICAgIGJ0bi5vbkNsaWNrKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9ucy5mb3JFYWNoKChiKSA9PiBiLnJlbW92ZUN0YSgpKTsgLy8gcmVtb3ZlIENUQSBmcm9tIGFsbCBidXR0b25zXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ0bi5zZXRDdGEoKTsgLy8gc2V0IENUQSB0byB0aGlzIGJ1dHRvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRyYW5zbGF0aW9uUGF0aCA9IGJ1dHRvblBhdGhNYXAuZ2V0KGJ0bik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZnJlc2hQcmV2aWV3KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIH0pXHJcblxyXG4gICAgICAgICAgICAgICAgLy8gcHJlc2VsZWN0IHRoZSBmaXJzdCBidXR0b24vdHJuYXNsYXRpb25cclxuICAgICAgICAgICAgICAgIGJ1dHRvbnMuZmlyc3QoKS5zZXRDdGEoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMudHJhbnNsYXRpb25QYXRoID0gYnV0dG9uUGF0aE1hcC5nZXQoYnV0dG9ucy5maXJzdCgpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICApXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBhZGQgbGluay1vbmx5IG9wdGlvbnNcclxuICAgICAgICB0aGlzLmxpbmtPbmx5ID0gdGhpcy5wbHVnaW5TZXR0aW5ncy5saW5rT25seTtcclxuICAgICAgICBuZXcgU2V0dGluZyhjb250ZW50RWwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKFwiTGluayBvbmx5XCIpXHJcbiAgICAgICAgICAgIC5hZGRUb2dnbGUoKHRnbCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGdsLnNldFZhbHVlKHRoaXMucGx1Z2luU2V0dGluZ3MubGlua09ubHkpXHJcbiAgICAgICAgICAgICAgICB0Z2wub25DaGFuZ2UodmFsID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxpbmtPbmx5ID0gdmFsO1xyXG4gICAgICAgICAgICAgICAgICAgIHJlZnJlc2hQcmV2aWV3KCk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9KVxyXG5cclxuICAgICAgICAvLyBBZGQgcHJldmlld1xyXG4gICAgICAgIGNvbnRlbnRFbC5jcmVhdGVFbChcImxhYmVsXCIsIHsgdGV4dDogXCJQcmV2aWV3XCIgfSk7XHJcbiAgICAgICAgcHJldmlld0VsID0gY29udGVudEVsLmNyZWF0ZUVsKFwidGV4dGFyZWFcIiwgeyBjbHM6ICdjb3B5LXByZXZpZXcnLCBhdHRyOiB7IHJlYWRvbmx5OiB0cnVlIH0gfSk7XHJcblxyXG5cclxuICAgICAgICAvLyBBZGQgYnV0dG9uIGZvciBzdWJtaXQvZXhpdFxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcclxuICAgICAgICAgICAgLmFkZEJ1dHRvbigoYnRuKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBidG5cclxuICAgICAgICAgICAgICAgICAgICAuc2V0QnV0dG9uVGV4dChcIkxpbmtcIilcclxuICAgICAgICAgICAgICAgICAgICAuc2V0Q3RhKClcclxuICAgICAgICAgICAgICAgICAgICAub25DbGljayh0aGlzLmhhbmRsZUlucHV0KVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gQWxsb3cgdXNlciB0byBleGl0IHVzaW5nIEVudGVyIGtleVxyXG4gICAgICAgIGNvbnRlbnRFbC5vbmtleWRvd24gPSAoZXZlbnQpID0+IHtcclxuICAgICAgICAgICAgaWYgKGV2ZW50LmtleSA9PT0gXCJFbnRlclwiKSB7XHJcbiAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVJbnB1dCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG9uQ2xvc2UoKSB7XHJcbiAgICAgICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XHJcbiAgICAgICAgY29udGVudEVsLmVtcHR5KCk7XHJcbiAgICB9XHJcbn1cclxuXHJcbiIsICJpbXBvcnQgeyBBcHAsIEhlYWRpbmdDYWNoZSwgTm90aWNlLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgeyBQbHVnaW5TZXR0aW5ncyB9IGZyb20gXCIuLi9tYWluXCI7XHJcbmltcG9ydCB7IGlzT0JTS0ZpbGUgfSBmcm9tIFwiLi4vdXRpbHMvcmVnZXhlc1wiO1xyXG5pbXBvcnQgeyBjYXBpdGFsaXplLCBnZXRGaWxlQnlGaWxlbmFtZSBhcyBnZXRURmlsZUJ5RmlsZW5hbWUsIHBhcnNlVXNlclZlcnNlSW5wdXQgfSBmcm9tIFwiLi9jb21tb25cIjtcclxuXHJcbi8qKlxyXG4gKiBDb252ZXJ0cyBiaWJsaWNhbCByZWZlcmVuY2UgdG8gdGV4dCBvZiBnaXZlbiB2ZXJzZXNcclxuICogQHBhcmFtIGFwcCBBcHAgaW5zdGFuY2VcclxuICogQHBhcmFtIHVzZXJJbnB1dCBVc2VyIElucHV0IChsaW5rIHRvIHZlcnNlKVxyXG4gKiBAcmV0dXJucyBTdHJpbmcgd2l0aCBxdW90ZSBvZiBsaW5rZWQgdmVyc2VzLiBJZiBjb252ZXJ0aW5nIHdhcyBub3Qgc3VjY2Vzc2Z1bCwgcmV0dXJucyBlbXB0eSBzdHJpbmcuXHJcbiAqIEB2ZXJib3NlIERldGVybWluZXMgaWYgTm90aWNlcyB3aWxsIGJlIHNob3duIG9yIG5vdFxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFRleHRPZlZlcnNlcyhhcHA6IEFwcCwgdXNlcklucHV0OiBzdHJpbmcsIHNldHRpbmdzOiBQbHVnaW5TZXR0aW5ncywgdHJhbnNsYXRpb25QYXRoOiBzdHJpbmcsIGxpbmtPbmx5OiBib29sZWFuLCB2ZXJib3NlID0gdHJ1ZSk6IFByb21pc2U8c3RyaW5nPiB7XHJcblxyXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHByZWZlci1jb25zdFxyXG4gICAgbGV0IHsgYm9va0FuZENoYXB0ZXIsIGJlZ2luVmVyc2UsIGVuZFZlcnNlIH0gPSBwYXJzZVVzZXJWZXJzZUlucHV0KHVzZXJJbnB1dCwgdmVyYm9zZSk7XHJcbiAgICBib29rQW5kQ2hhcHRlciA9IGNhcGl0YWxpemUoYm9va0FuZENoYXB0ZXIpIC8vIEZvciBvdXRwdXQgY29uc2lzdGVuY3lcclxuICAgIGNvbnN0IHsgZmlsZU5hbWUsIHRGaWxlIH0gPSBnZXRURmlsZUJ5RmlsZW5hbWUoYXBwLCBib29rQW5kQ2hhcHRlciwgdHJhbnNsYXRpb25QYXRoKTtcclxuICAgIGlmICh0RmlsZSkge1xyXG4gICAgICAgIHJldHVybiBhd2FpdCBjcmVhdGVDb3B5T3V0cHV0KGFwcCwgdEZpbGUsIGZpbGVOYW1lLCBiZWdpblZlcnNlLCBlbmRWZXJzZSwgc2V0dGluZ3MsIHRyYW5zbGF0aW9uUGF0aCwgbGlua09ubHksIHZlcmJvc2UpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBpZiAodmVyYm9zZSkge1xyXG4gICAgICAgICAgICBuZXcgTm90aWNlKGBGaWxlICR7Ym9va0FuZENoYXB0ZXJ9IG5vdCBmb3VuZGApO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aHJvdyBcIkZpbGUgbm90IGZvdW5kXCJcclxuICAgIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFJldHVybnMgdGV4dCBvZiBnaXZlbiB2ZXJzZSB1c2luZyBnaXZlbiBoZWFkaW5ncyBhbmQgbGluZXMuXHJcbiAqIEBwYXJhbSB2ZXJzZU51bWJlciBOdW1iZXIgb2YgZGVzaXJlZCB2ZXJzZS5cclxuICogQHBhcmFtIGhlYWRpbmdzIExpc3Qgb2YgaGVhZGluZ3MgdGhhdCBzaG91bGQgYmUgc2VhcmNoZWQuIFNlY29uZCBoZWFkaW5nIG11c3QgY29ycmVzcG9uZCB0byBmaXJzdCB2ZXJzZSwgdGhpcmQgaGVhZGluZyB0byBzZWNvbmQgdmVyc2UgYW5kIHNvIG9uLlxyXG4gKiBAcGFyYW0gbGluZXMgTGluZXMgb2YgZmlsZSBmcm9tIHdoaWNoIHZlcnNlIHRleHQgc2hvdWxkIGJlIHRha2VuLlxyXG4gKiBAcGFyYW0ga2VlcE5ld2xpbmVzIElmIHNldCB0byB0cnVlLCB0ZXh0IHdpbGwgY29udGFpbiBuZXdsaW5lcyBpZiBwcmVzZW50IGluIHNvdXJjZSwgaWYgc2V0IHRvIGZhbHNlLCBuZXdsaW5lcyB3aWxsIGJlIGNoYW5nZWQgdG8gc3BhY2VzXHJcbiAqIEBwYXJhbSBuZXdMaW5lUHJlZml4IFByZWZpeCBmb3IgZWFjaCBsaW5lIG9mIHZlcnNlLCBpZiB2ZXJzZSBpcyBtdWx0aWxpbmUgYW5kIGtlZXBOZXdMaW5lcyA9IHRydWVcclxuICogQHJldHVybnMgVGV4dCBvZiBnaXZlbiB2ZXJzZS5cclxuICovXHJcbmZ1bmN0aW9uIGdldFZlcnNlVGV4dCh2ZXJzZU51bWJlcjogbnVtYmVyLCBoZWFkaW5nczogSGVhZGluZ0NhY2hlW10sIGxpbmVzOiBzdHJpbmdbXSwga2VlcE5ld2xpbmVzOiBib29sZWFuLCBuZXdMaW5lUHJlZml4OiBzdHJpbmcpIHtcclxuICAgIGlmICh2ZXJzZU51bWJlciA+PSBoZWFkaW5ncy5sZW5ndGgpIHsgLy8gb3V0IG9mIHJhbmdlXHJcbiAgICAgICAgbmV3IE5vdGljZShcIlZlcnNlIG91dCBvZiByYW5nZSBmb3IgZ2l2ZW4gZmlsZVwiKVxyXG4gICAgICAgIHRocm93IGBWZXJzZU51bWJlciAke3ZlcnNlTnVtYmVyfSBpcyBvdXQgb2YgcmFuZ2Ugb2YgaGVhZGluZ3Mgd2l0aCBsZW5ndGggJHtoZWFkaW5ncy5sZW5ndGh9YFxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGhlYWRpbmdMaW5lID0gaGVhZGluZ3NbdmVyc2VOdW1iZXJdLnBvc2l0aW9uLnN0YXJ0LmxpbmU7XHJcbiAgICBpZiAoaGVhZGluZ0xpbmUgKyAxID49IGxpbmVzLmxlbmd0aCkgeyAvLyBvdXQgb2YgcmFuZ2VcclxuICAgICAgICBuZXcgTm90aWNlKFwiTG9naWNhbCBlcnJvciAtIHBsZWFzZSBjcmVhdGUgaXNzdWUgb24gcGx1Z2luJ3MgR2l0SHViIHdpdGggeW91ciBpbnB1dCBhbmQgdGhlIGZpbGUgeW91IHdlcmUgcmVmZXJlbmNpbmcuIFRoYW5rIHlvdSFcIilcclxuICAgICAgICB0aHJvdyBgSGVhZGluZ0xpbmUgJHtoZWFkaW5nTGluZSArIDF9IGlzIG91dCBvZiByYW5nZSBvZiBsaW5lcyB3aXRoIGxlbmd0aCAke2xpbmVzfWBcclxuICAgIH1cclxuXHJcbiAgICAvLyBUaGlzIHBhcnQgaXMgbmVjZXNzYXJ5IGZvciB2ZXJzZXMgdGhhdCBzcGFuIG92ZXIgbXVsdGlwbGUgbGluZXNcclxuICAgIGxldCBvdXRwdXQgPSBcIlwiO1xyXG4gICAgbGV0IGxpbmUgPSBcIlwiO1xyXG4gICAgbGV0IGkgPSAxO1xyXG4gICAgbGV0IGlzRmlyc3QgPSB0cnVlO1xyXG5cclxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zdGFudC1jb25kaXRpb25cclxuICAgIHdoaWxlICh0cnVlKSB7XHJcbiAgICAgICAgbGluZSA9IGxpbmVzW2hlYWRpbmdMaW5lICsgaV07IC8vIGdldCBuZXh0IGxpbmVcclxuICAgICAgICBpZiAoL14jLy50ZXN0KGxpbmUpIHx8ICghbGluZSAmJiAhaXNGaXJzdCkpIHtcclxuICAgICAgICAgICAgYnJlYWs7IC8vIGhlYWRpbmcgbGluZSAobmV4dCB2ZXJzZSkgb3IgZW1wdHkgbGluZSBhZnRlciB2ZXJzZSA9PiBkbyBub3QgY29udGludWVcclxuICAgICAgICB9XHJcbiAgICAgICAgaSsrO1xyXG4gICAgICAgIGlmIChsaW5lKSB7IC8vIGlmIGxpbmUgaGFzIGNvbnRlbnQgKGlzIG5vdCBlbXB0eSBzdHJpbmcpXHJcbiAgICAgICAgICAgIGlmICghaXNGaXJzdCkgeyAvLyBJZiBpdCBpcyBub3QgZmlyc3QgbGluZSBvZiB0aGUgdmVyc2UsIGFkZCBkaXZpZGVyXHJcbiAgICAgICAgICAgICAgICBvdXRwdXQgKz0ga2VlcE5ld2xpbmVzID8gYFxcbiR7bmV3TGluZVByZWZpeH1gIDogXCIgXCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaXNGaXJzdCA9IGZhbHNlO1xyXG4gICAgICAgICAgICBvdXRwdXQgKz0gbGluZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gb3V0cHV0O1xyXG59XHJcblxyXG4vKipcclxuICogUmVwbGFjZXMgXCJcXG5cIiB3aXRoIG5ld2xpbmUgY2hhcmFjdGVyIGluIGdpdmVuIHN0cmluZyAod2hlbiB1c2VyIGlucHV0cyBcIlxcblwiIGluIHRoZSBzZXR0aW5ncyBpdCBpcyBhdXRvbWF0aWNhbGx5IGNvbnZlcnRlZCB0byBcIlxcXFxuXCIgYW5kIGRvZXMgbm90IHdvcmsgYXMgbmV3bGluZSlcclxuICovXHJcbmZ1bmN0aW9uIHJlcGxhY2VOZXdsaW5lKGlucHV0OiBzdHJpbmcpIHtcclxuICAgIHJldHVybiBpbnB1dC5yZXBsYWNlKC9cXFxcbi9nLCBcIlxcblwiLCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBUYWtlcyBvcmdpbmFsIGZpbGVuYW1lIGFuZCBjb252ZXJ0cyBpdCB0byBodW1hbi1yZWFkYWJsZSB2ZXJzaW9uIGlmIEJpYmxlIHN0dWR5IGtpdCBpcyB1c2VkIChyZW1vdmVzIFwiLVwiIGFuZCBsZWFkaW5nIHplcm9zKVxyXG4gKi9cclxuZnVuY3Rpb24gY3JlYXRlQm9va0FuZENoYXB0ZXJPdXRwdXQoZmlsZUJhc2VuYW1lOiBzdHJpbmcpIHtcclxuICAgIGlmIChpc09CU0tGaWxlLnRlc3QoZmlsZUJhc2VuYW1lKSkge1xyXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBwcmVmZXItY29uc3RcclxuICAgICAgICBsZXQgWywgZmlsZW5hbWUsIGNoYXB0ZXJdID0gZmlsZUJhc2VuYW1lLm1hdGNoKGlzT0JTS0ZpbGUpO1xyXG4gICAgICAgIGlmIChjaGFwdGVyLnRvU3RyaW5nKClbMF0gPT09IFwiMFwiKSB7XHJcbiAgICAgICAgICAgIGNoYXB0ZXIgPSBjaGFwdGVyLnN1YnN0cmluZygxKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZpbGVuYW1lICsgXCIgXCIgKyBjaGFwdGVyO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGZpbGVCYXNlbmFtZTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFJldHVybnMgcGF0aCB0byBmb2xkZXIgaW4gd2hpY2ggZ2l2ZW4gZmlsZSBpcyBsb2NhdGVkIGZvciBtYWluIHRyYW5zbGF0aW9uXHJcbiAqL1xyXG5mdW5jdGlvbiBnZXRGaWxlRm9sZGVySW5UcmFuc2xhdGlvbihhcHA6IEFwcCwgZmlsZW5hbWU6IHN0cmluZywgdHJhbnNsYXRpb246IHN0cmluZykge1xyXG4gICAgY29uc3QgdEZpbGVJbmZvID0gZ2V0VEZpbGVCeUZpbGVuYW1lKGFwcCwgZmlsZW5hbWUsIHRyYW5zbGF0aW9uKTtcclxuICAgIHJldHVybiB0RmlsZUluZm8udEZpbGUucGFyZW50LnBhdGg7XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUNvcHlPdXRwdXQoYXBwOiBBcHAsIHRGaWxlOiBURmlsZSwgZmlsZU5hbWU6IHN0cmluZywgYmVnaW5WZXJzZTogbnVtYmVyLCBlbmRWZXJzZTogbnVtYmVyLCBzZXR0aW5nczogUGx1Z2luU2V0dGluZ3MsIHRyYW5zbGF0aW9uUGF0aDogc3RyaW5nLCBsaW5rT25seTogYm9vbGVhbiwgdmVyYm9zZTogYm9vbGVhbikge1xyXG4gICAgY29uc3QgYm9va0FuZENoYXB0ZXJPdXRwdXQgPSBjcmVhdGVCb29rQW5kQ2hhcHRlck91dHB1dCh0RmlsZS5iYXNlbmFtZSk7XHJcbiAgICBjb25zdCBmaWxlID0gYXBwLnZhdWx0LnJlYWQodEZpbGUpXHJcbiAgICBjb25zdCBsaW5lcyA9IChhd2FpdCBmaWxlKS5zcGxpdCgvXFxyP1xcbi8pXHJcbiAgICBjb25zdCB2ZXJzZUhlYWRpbmdMZXZlbCA9IHNldHRpbmdzLnZlcnNlSGVhZGluZ0xldmVsXHJcbiAgICBjb25zdCBoZWFkaW5ncyA9IGFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZSh0RmlsZSkuaGVhZGluZ3MuZmlsdGVyKGhlYWRpbmcgPT4gIXZlcnNlSGVhZGluZ0xldmVsIHx8IGhlYWRpbmcubGV2ZWwgPT09IHZlcnNlSGVhZGluZ0xldmVsKVxyXG4gICAgY29uc3QgYmVnaW5WZXJzZU5vT2Zmc2V0ID0gYmVnaW5WZXJzZVxyXG4gICAgYmVnaW5WZXJzZSArPSBzZXR0aW5ncy52ZXJzZU9mZnNldFxyXG4gICAgZW5kVmVyc2UgKz0gc2V0dGluZ3MudmVyc2VPZmZzZXRcclxuICAgIHZhciBuck9mVmVyc2VzID0gaGVhZGluZ3MubGVuZ3RoIC0gMTtcclxuICAgIHZhciBtYXhWZXJzZSA9IGVuZFZlcnNlIDwgbnJPZlZlcnNlcyA/IGVuZFZlcnNlIDogbnJPZlZlcnNlczsgLy8gaWYgZW5kdmVyc2UgaXMgYmlnZ2VyIHRoYW4gY2hhcHRlciBhbGxvd3MsIGl0IGlzIGxvd2VyZWQgdG8gbWF4aW11bVxyXG4gICAgdmFyIG1heFZlcnNlTm9PZmZzZXQgPSBtYXhWZXJzZSAtIHNldHRpbmdzLnZlcnNlT2Zmc2V0O1xyXG5cclxuXHJcbiAgICBpZiAoYmVnaW5WZXJzZSA+IG1heFZlcnNlKSB7XHJcbiAgICAgICAgaWYgKHZlcmJvc2UpIHtcclxuICAgICAgICAgICAgbmV3IE5vdGljZShcIkJlZ2luIHZlcnNlIGlzIGJpZ2dlciB0aGFuIGVuZCB2ZXJzZSBvciBjaGFwdGVyIG1heGltdW1cIilcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhyb3cgXCJCZWdpbiB2ZXJzZSBpcyBiaWdnZXIgdGhhbiBlbmQgdmVyc2Ugb3IgY2hhcHRlciBtYXhpbXVtXCJcclxuICAgIH1cclxuXHJcblxyXG4gICAgLy8gMSAtIExpbmsgdG8gdmVyc2VzXHJcbiAgICBsZXQgcG9zdGZpeCA9IFwiXCIsIHJlcyA9IFwiXCIsIHBhdGhUb1VzZSA9IFwiXCI7XHJcbiAgICBpZiAoIWxpbmtPbmx5KSB7XHJcbiAgICAgICAgcmVzID0gc2V0dGluZ3MucHJlZml4O1xyXG4gICAgICAgIHBvc3RmaXggPSBzZXR0aW5ncy5wb3N0Zml4ID8gcmVwbGFjZU5ld2xpbmUoc2V0dGluZ3MucG9zdGZpeCkgOiBcIiBcIjtcclxuICAgIH1cclxuICAgIGlmIChzZXR0aW5ncy5lbmFibGVNdWx0aXBsZVRyYW5zbGF0aW9ucykge1xyXG4gICAgICAgIGlmIChzZXR0aW5ncy50cmFuc2xhdGlvbkxpbmtpbmdUeXBlICE9PSBcIm1haW5cIikgLy8gbGluayB0aGUgdHJhbnNsYXRpb24gdGhhdCBpcyBjdXJyZW50bHkgYmVpbmcgdXNlZFxyXG4gICAgICAgICAgICBwYXRoVG9Vc2UgPSBnZXRGaWxlRm9sZGVySW5UcmFuc2xhdGlvbihhcHAsIGZpbGVOYW1lLCB0cmFuc2xhdGlvblBhdGgpO1xyXG4gICAgICAgIGVsc2UgeyAvLyBsaW5rIG1haW4gdHJhbnNsYXRpb25cclxuICAgICAgICAgICAgcGF0aFRvVXNlID0gZ2V0RmlsZUZvbGRlckluVHJhbnNsYXRpb24oYXBwLCBmaWxlTmFtZSwgc2V0dGluZ3MucGFyc2VkVHJhbnNsYXRpb25QYXRocy5maXJzdCgpKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGJlZ2luVmVyc2UgPT09IG1heFZlcnNlKSB7XHJcbiAgICAgICAgcmVzICs9IGBbWyR7cGF0aFRvVXNlID8gcGF0aFRvVXNlICsgXCIvXCIgOiBcIlwifSR7ZmlsZU5hbWV9IyR7aGVhZGluZ3NbYmVnaW5WZXJzZV0uaGVhZGluZ318JHtib29rQW5kQ2hhcHRlck91dHB1dH0ke3NldHRpbmdzLm9uZVZlcnNlTm90YXRpb259JHtiZWdpblZlcnNlTm9PZmZzZXR9XV0ke3Bvc3RmaXh9YCAvLyBbW0dlbiAxIzF8R2VuIDEsMS4xXV1cclxuICAgIH0gZWxzZSBpZiAoc2V0dGluZ3MubGlua0VuZFZlcnNlKSB7XHJcbiAgICAgICAgcmVzICs9IGBbWyR7cGF0aFRvVXNlID8gcGF0aFRvVXNlICsgXCIvXCIgOiBcIlwifSR7ZmlsZU5hbWV9IyR7aGVhZGluZ3NbYmVnaW5WZXJzZV0uaGVhZGluZ318JHtib29rQW5kQ2hhcHRlck91dHB1dH0ke3NldHRpbmdzLm11bHRpcGxlVmVyc2VzTm90YXRpb259JHtiZWdpblZlcnNlTm9PZmZzZXR9LV1dYCAvLyBbW0dlbiAxIzF8R2VuIDEsMS1dXVxyXG4gICAgICAgIHJlcyArPSBgW1ske3BhdGhUb1VzZSA/IHBhdGhUb1VzZSArIFwiL1wiIDogXCJcIn0ke2ZpbGVOYW1lfSMke2hlYWRpbmdzW21heFZlcnNlXS5oZWFkaW5nfXwke21heFZlcnNlTm9PZmZzZXR9XV0ke3Bvc3RmaXh9YDsgLy8gW1tHZW4gMSMzfDNdXVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICByZXMgKz0gYFtbJHtwYXRoVG9Vc2UgPyBwYXRoVG9Vc2UgKyBcIi9cIiA6IFwiXCJ9JHtmaWxlTmFtZX0jJHtoZWFkaW5nc1tiZWdpblZlcnNlXS5oZWFkaW5nfXwke2Jvb2tBbmRDaGFwdGVyT3V0cHV0fSR7c2V0dGluZ3MubXVsdGlwbGVWZXJzZXNOb3RhdGlvbn0ke2JlZ2luVmVyc2VOb09mZnNldH0tJHttYXhWZXJzZU5vT2Zmc2V0fV1dJHtwb3N0Zml4fWAgLy8gW1tHZW4gMSMxfEdlbiAxLDEtM11dXHJcbiAgICB9XHJcblxyXG4gICAgLy8gMiAtIFRleHQgb2YgdmVyc2VzXHJcbiAgICBpZiAoIWxpbmtPbmx5KSB7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IGJlZ2luVmVyc2U7IGkgPD0gbWF4VmVyc2U7IGkrKykge1xyXG4gICAgICAgICAgICBsZXQgdmVyc2VQcmVmaXggPSBcIlwiO1xyXG4gICAgICAgICAgICBjb25zdCB2ZXJzZVBvc3RmaXggPSBzZXR0aW5ncy5pbnNlcnRTcGFjZSA/IFwiIFwiIDogXCJcIjtcclxuICAgICAgICAgICAgaWYgKHNldHRpbmdzLmVhY2hWZXJzZVByZWZpeCkge1xyXG4gICAgICAgICAgICAgICAgdmVyc2VQcmVmaXggKz0gc2V0dGluZ3MuZWFjaFZlcnNlUHJlZml4LnJlcGxhY2UoL3tufS9nLCAoaSAtIHNldHRpbmdzLnZlcnNlT2Zmc2V0KS50b1N0cmluZygpKTtcclxuICAgICAgICAgICAgICAgIHZlcnNlUHJlZml4ID0gdmVyc2VQcmVmaXgucmVwbGFjZSgve2Z9L2csIGAke2ZpbGVOYW1lfWApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IHZlcnNlVGV4dCA9IGdldFZlcnNlVGV4dChpLCBoZWFkaW5ncywgbGluZXMsIHNldHRpbmdzLm5ld0xpbmVzLCBzZXR0aW5ncy5wcmVmaXgpO1xyXG4gICAgICAgICAgICBpZiAoc2V0dGluZ3MubmV3TGluZXMpIHtcclxuICAgICAgICAgICAgICAgIHJlcyArPSBcIlxcblwiICsgc2V0dGluZ3MucHJlZml4ICsgdmVyc2VQcmVmaXggKyB2ZXJzZVRleHQ7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXMgKz0gdmVyc2VQcmVmaXggKyB2ZXJzZVRleHQgKyB2ZXJzZVBvc3RmaXg7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gMyAtIEludmlzaWJsZSBsaW5rc1xyXG4gICAgaWYgKCFzZXR0aW5ncy51c2VJbnZpc2libGVMaW5rcykgcmV0dXJuIHJlcztcclxuICAgIGlmIChiZWdpblZlcnNlID09IG1heFZlcnNlIC8vIE5vIG5lZWQgdG8gYWRkIGFub3RoZXIgbGluaywgd2hlbiBvbmx5IG9uZSB2ZXJzZSBpcyBiZWluZyBsaW5rZWRcclxuICAgICAgICAmJiAoIXNldHRpbmdzLmVuYWJsZU11bHRpcGxlVHJhbnNsYXRpb25zXHJcbiAgICAgICAgICAgIHx8IHNldHRpbmdzLnRyYW5zbGF0aW9uTGlua2luZ1R5cGUgPT09IFwibWFpblwiXHJcbiAgICAgICAgICAgIHx8IHNldHRpbmdzLnRyYW5zbGF0aW9uTGlua2luZ1R5cGUgPT09IFwidXNlZFwiKSkgLy8gT25seSBsaW5raW5nIG9uZSB0cmFuc2xhdGlvbiAtIGFscmVhZHkgbGlua2VkIFxyXG4gICAgICAgIHJldHVybiByZXM7XHJcblxyXG4gICAgaWYgKHNldHRpbmdzLm5ld0xpbmVzICYmICFsaW5rT25seSkge1xyXG4gICAgICAgIHJlcyArPSBgXFxuJHtzZXR0aW5ncy5wcmVmaXh9YDtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBsYXN0VmVyc2VUb0xpbmsgPSBzZXR0aW5ncy5saW5rRW5kVmVyc2UgPyBtYXhWZXJzZSAtIDEgOiBtYXhWZXJzZTtcclxuICAgIGZvciAobGV0IGkgPSBiZWdpblZlcnNlICsgMTsgaSA8PSBsYXN0VmVyc2VUb0xpbms7IGkrKykgeyAvLyBiZWdpblZlcnNlICsgMSBiZWNhdXNlIGxpbmsgdG8gZmlyc3QgdmVyc2UgaXMgYWxyZWFkeSBpbnNlcnRlZCBiZWZvcmUgdGhlIHRleHRcclxuICAgICAgICBpZiAoIXNldHRpbmdzLmVuYWJsZU11bHRpcGxlVHJhbnNsYXRpb25zKSB7XHJcbiAgICAgICAgICAgIHJlcyArPSBgW1ske2ZpbGVOYW1lfSMke2hlYWRpbmdzW2ldLmhlYWRpbmd9fF1dYFxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHsgLy8gbXVsdGlwbGUgdHJhbnNsYXRpb25zIFxyXG4gICAgICAgICAgICBsZXQgdHJhbnNsYXRpb25QYXRoc1RvVXNlOiBzdHJpbmdbXSA9IFtdO1xyXG4gICAgICAgICAgICBzd2l0Y2ggKHNldHRpbmdzLnRyYW5zbGF0aW9uTGlua2luZ1R5cGUpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgXCJhbGxcIjpcclxuICAgICAgICAgICAgICAgICAgICB0cmFuc2xhdGlvblBhdGhzVG9Vc2UgPSBzZXR0aW5ncy5wYXJzZWRUcmFuc2xhdGlvblBhdGhzLm1hcCgodHIpID0+IGdldEZpbGVGb2xkZXJJblRyYW5zbGF0aW9uKGFwcCwgZmlsZU5hbWUsIHRyKSlcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgXCJ1c2VkXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgdHJhbnNsYXRpb25QYXRoc1RvVXNlID0gW2dldEZpbGVGb2xkZXJJblRyYW5zbGF0aW9uKGFwcCwgZmlsZU5hbWUsIHRyYW5zbGF0aW9uUGF0aCldXHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwidXNlZEFuZE1haW5cIjpcclxuICAgICAgICAgICAgICAgICAgICBpZiAodHJhbnNsYXRpb25QYXRoICE9PSBzZXR0aW5ncy5wYXJzZWRUcmFuc2xhdGlvblBhdGhzLmZpcnN0KCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNsYXRpb25QYXRoc1RvVXNlID0gW2dldEZpbGVGb2xkZXJJblRyYW5zbGF0aW9uKGFwcCwgZmlsZU5hbWUsIHRyYW5zbGF0aW9uUGF0aCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGdldEZpbGVGb2xkZXJJblRyYW5zbGF0aW9uKGFwcCwgZmlsZU5hbWUsIHNldHRpbmdzLnBhcnNlZFRyYW5zbGF0aW9uUGF0aHMuZmlyc3QoKSldO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNsYXRpb25QYXRoc1RvVXNlID0gW2dldEZpbGVGb2xkZXJJblRyYW5zbGF0aW9uKGFwcCwgZmlsZU5hbWUsIHRyYW5zbGF0aW9uUGF0aCldO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgXCJtYWluXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgdHJhbnNsYXRpb25QYXRoc1RvVXNlID0gW2dldEZpbGVGb2xkZXJJblRyYW5zbGF0aW9uKGFwcCwgZmlsZU5hbWUsIHNldHRpbmdzLnBhcnNlZFRyYW5zbGF0aW9uUGF0aHMuZmlyc3QoKSldO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0cmFuc2xhdGlvblBhdGhzVG9Vc2UuZm9yRWFjaCgodHJhbnNsYXRpb25QYXRoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICByZXMgKz0gYFtbJHt0cmFuc2xhdGlvblBhdGh9LyR7ZmlsZU5hbWV9IyR7aGVhZGluZ3NbaV0uaGVhZGluZ318XV1gXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuICAgIHJldHVybiByZXM7XHJcbn1cclxuIiwgIi8qXHJcbiogUmVnZXhlcyBmb3IgdmVyc2UgcGFyc2luZ1xyXG4qL1xyXG5cclxuLy8gTGluayB0byBvbmUgdmVyc2UsIGZvciBleGFtcGxlIFwiR2VuIDEuMVwiIG9yIFwiR2VuIDE6MVwiXHJcbmV4cG9ydCBjb25zdCBvbmVWZXJzZVJlZ0V4ID0gbmV3IFJlZ0V4cCgvKFteLDojXSspWywjLjo7XVxccyooXFxkKylcXHMqJC8pO1xyXG5cclxuLy8gTGluayB0byBtdWx0aXBsZSB2ZXJzZXMsIGZvciBleGFtcGxlIFwiR2VuIDEsMS01XCJcclxuZXhwb3J0IGNvbnN0IG11bHRpcGxlVmVyc2VzUmVnRXggPSBuZXcgUmVnRXhwKC8oW14sOiNdKylbLCMuOjtdXFxzKihcXGQrKVxccypbLS49XVxccyooXFxkKylcXHMqJC8pO1xyXG5cclxuLy8gQm9vayBhbmQgY2hhcHRlciBzdHJpbmcgKHVzZWQgZm9yIGNvbnZlcnRpbmcgdG8gYmlibGUgc3R1ZHkga2l0IGZpbGUgbmFtZXMpXHJcbmV4cG9ydCBjb25zdCBib29rQW5kQ2hhcHRlclJlZ2V4Rm9yT0JTSyA9IC8oW14sOiNdKylcXHMoXFxkKykvXHJcblxyXG4vLyBNdWx0aXBsZSBjaGFwdGVycywgZm9yIGV4YW1wbGUgXCJHZW4gMS0zXCJcclxuZXhwb3J0IGNvbnN0IG11bHRpcGxlQ2hhcHRlcnMgPSAvKFxcZCpbXlxcZCw6I10rKVxccyooXFxkKylcXHMqLVxccyooXFxkKylcXHMqJC9cclxuXHJcbi8vIENhbiBiZSB1c2VkIHRvIGRldGVybWluZSB3aGV0aGVyIGdpdmVuIG5hbWUgb2YgZmlsZSBpcyBmcm9tIE9CU0sgKGZvciBleGFtcGxlIEdlbi0wMSlcclxuZXhwb3J0IGNvbnN0IGlzT0JTS0ZpbGUgPSAvKFthLXpBLVowLTkgXSspLShcXGR7MiwzfSkvXHJcbiIsICIvKlxyXG4gKiBDYXBpdGFsaXplcyBnaXZlbiBzdHJpbmcgKHNraXBzIGxlYWRpbmcgd2hpdGVzcGFjZXMgYW5kIG51bWJlcnMpXHJcbiAqL1xyXG5pbXBvcnQgeyBib29rQW5kQ2hhcHRlclJlZ2V4Rm9yT0JTSywgbXVsdGlwbGVDaGFwdGVycywgbXVsdGlwbGVWZXJzZXNSZWdFeCwgb25lVmVyc2VSZWdFeCB9IGZyb20gXCIuLi91dGlscy9yZWdleGVzXCI7XHJcbmltcG9ydCB7IEFwcCwgTm90aWNlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcblxyXG4vKipcclxuICogQ2FwaXRhbGl6ZXMgZ2l2ZW4gc3RyaW5nLCB0YWtpbmcgbGVhZGluZyBudW1iZXJzIGludG8gYWNjb3VudFxyXG4gKiBAcGFyYW0gc3RyIFN0cmluZyB0aGF0IHNob3VsZCBiZSBjYXBpdGFsaXplZFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGNhcGl0YWxpemUoc3RyOiBzdHJpbmcpIHtcclxuICAgIHN0ciA9IHN0ci50b0xvY2FsZUxvd2VyQ2FzZSgpO1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBpZiAoL1teXFxzXFxkLiwjLV0vLnRlc3Qoc3RyLmNoYXJBdChpKSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHN0ci5zbGljZSgwLCBpKSArIHN0ci5jaGFyQXQoaSkudG9VcHBlckNhc2UoKSArIHN0ci5zbGljZShpICsgMSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHN0cjtcclxufVxyXG5cclxuLyoqXHJcbiAqIFBhcnNlcyBpbnB1dCBmcm9tIHVzZXIsIGV4cGVjdGluZyBjaGFwdGVyIGFuZCB2ZXJzZXNcclxuICogQHBhcmFtIHVzZXJJbnB1dFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlVXNlclZlcnNlSW5wdXQodXNlcklucHV0OiBzdHJpbmcsIHZlcmJvc2UgPSB0cnVlKSB7XHJcbiAgICBsZXQgYm9va0FuZENoYXB0ZXI7XHJcbiAgICBsZXQgYmVnaW5WZXJzZTtcclxuICAgIGxldCBlbmRWZXJzZTtcclxuXHJcbiAgICBzd2l0Y2ggKHRydWUpIHtcclxuICAgICAgICBjYXNlIG9uZVZlcnNlUmVnRXgudGVzdCh1c2VySW5wdXQpOiB7IC8vIG9uZSB2ZXJzZVxyXG4gICAgICAgICAgICBjb25zdCBbLCBtYXRjaGVkQ2hhcHRlciwgbWF0Y2hlZFZlcnNlXSA9IHVzZXJJbnB1dC5tYXRjaChvbmVWZXJzZVJlZ0V4KVxyXG4gICAgICAgICAgICBib29rQW5kQ2hhcHRlciA9IG1hdGNoZWRDaGFwdGVyO1xyXG4gICAgICAgICAgICBiZWdpblZlcnNlID0gTnVtYmVyKG1hdGNoZWRWZXJzZSk7XHJcbiAgICAgICAgICAgIGVuZFZlcnNlID0gTnVtYmVyKG1hdGNoZWRWZXJzZSk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYXNlIG11bHRpcGxlVmVyc2VzUmVnRXgudGVzdCh1c2VySW5wdXQpOiB7IC8vIG11bHRpcGxlIHZlcnNlcywgb25lIGNoYXB0ZXJcclxuICAgICAgICAgICAgY29uc3QgWywgbWF0Y2hlZENoYXB0ZXIsIG1hdGNoZWRCZWdpblZlcnNlLCBtYXRjaGVkRW5kVmVyc2VdID0gdXNlcklucHV0Lm1hdGNoKG11bHRpcGxlVmVyc2VzUmVnRXgpXHJcbiAgICAgICAgICAgIGJvb2tBbmRDaGFwdGVyID0gbWF0Y2hlZENoYXB0ZXI7XHJcbiAgICAgICAgICAgIGJlZ2luVmVyc2UgPSBOdW1iZXIobWF0Y2hlZEJlZ2luVmVyc2UpO1xyXG4gICAgICAgICAgICBlbmRWZXJzZSA9IE51bWJlcihtYXRjaGVkRW5kVmVyc2UpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICAgICAgZGVmYXVsdDoge1xyXG4gICAgICAgICAgICBpZiAodmVyYm9zZSkge1xyXG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZShgV3JvbmcgZm9ybWF0IFwiJHt1c2VySW5wdXR9XCJgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aHJvdyBcIkNvdWxkIG5vdCBwYXJzZSB1c2VyIGlucHV0XCJcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHsgYm9va0FuZENoYXB0ZXIsIGJlZ2luVmVyc2UsIGVuZFZlcnNlIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFBhcnNlcyBpbnB1dCBmcm9tIHVzZXIsIGV4cGVjdGluZyBtdWx0aXBsZSBjaGFwdGVyc1xyXG4gKiBAcGFyYW0gdXNlcklucHV0XHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VVc2VyQm9va0lucHV0KHVzZXJJbnB1dDogc3RyaW5nKSB7XHJcbiAgICBsZXQgYm9vaztcclxuICAgIGxldCBmaXJzdENoYXB0ZXI7XHJcbiAgICBsZXQgbGFzdENoYXB0ZXI7XHJcblxyXG4gICAgc3dpdGNoICh0cnVlKSB7XHJcbiAgICAgICAgY2FzZSBtdWx0aXBsZUNoYXB0ZXJzLnRlc3QodXNlcklucHV0KTogeyAvLyBvbmUgdmVyc2VcclxuICAgICAgICAgICAgY29uc3QgWywgbWF0Y2hlZEJvb2ssIG1hdGNoZWRGaXJzdENoYXB0ZXIsIG1hdGNoZWRMYXN0Q2hhcHRlcl0gPSB1c2VySW5wdXQubWF0Y2gobXVsdGlwbGVDaGFwdGVycylcclxuICAgICAgICAgICAgYm9vayA9IG1hdGNoZWRCb29rLnRyaW0oKTtcclxuICAgICAgICAgICAgZmlyc3RDaGFwdGVyID0gTnVtYmVyKG1hdGNoZWRGaXJzdENoYXB0ZXIpO1xyXG4gICAgICAgICAgICBsYXN0Q2hhcHRlciA9IE51bWJlcihtYXRjaGVkTGFzdENoYXB0ZXIpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICAgICAgZGVmYXVsdDoge1xyXG4gICAgICAgICAgICBuZXcgTm90aWNlKGBXcm9uZyBmb3JtYXQgXCIke3VzZXJJbnB1dH1cImApO1xyXG4gICAgICAgICAgICB0aHJvdyBcIkNvdWxkIG5vdCBwYXJzZSB1c2VyIGlucHV0XCJcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHsgYm9vaywgZmlyc3RDaGFwdGVyLCBsYXN0Q2hhcHRlciB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBUcmllcyB0byBnZXQgdEZpbGUgY29ycmVzcG9uZGluZyB0byBnaXZlbiBmaWxlbmFtZS4gSWYgdGhlIGZpbGUgaXMgbm90IGZvdW5kLCBmaWxlbmFtZSBpcyBjb252ZXJ0ZWQgdG8gbWF0Y2ggT2JzaWRpYW5cclxuICogQmlibGUgU3R1ZHkgS2l0IG5hbWluZyBjb252ZW50aW9uIGFuZCB0aGUgb3BlcmF0aW9uIGlzIHJlcGVhdGVkLlxyXG4gKiBAcGFyYW0gYXBwXHJcbiAqIEBwYXJhbSBmaWxlbmFtZSBOYW1lIG9mIGZpbGUgdGhhdCBzaG91bGQgYmUgc2VhcmNoZWRcclxuICogQHBhcmFtIHBhdGggUGF0aCB3aGVyZSB0aGUgc2VhcmNoIHNob3VsZCBvY2N1cmVcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRGaWxlQnlGaWxlbmFtZShhcHA6IEFwcCwgZmlsZW5hbWU6IHN0cmluZywgcGF0aCA9IFwiL1wiKSB7XHJcbiAgICBsZXQgZmlsZW5hbWVDb3B5ID0gZmlsZW5hbWU7XHJcbiAgICBsZXQgdEZpbGUgPSBhcHAubWV0YWRhdGFDYWNoZS5nZXRGaXJzdExpbmtwYXRoRGVzdChmaWxlbmFtZUNvcHksIHBhdGgpXHJcbiAgICBpZiAoIXRGaWxlKSB7IC8vIGhhbmRsZSBcIkJpYmxlIHN0dWR5IGtpdFwiIGZpbGUgbmFtaW5nLCBlZy4gR2VuLTAxIGluc3RlYWQgb2YgR2VuIDFcclxuICAgICAgICBmaWxlbmFtZUNvcHkgPSB0cnlDb252ZXJ0VG9PQlNLRmlsZU5hbWUoZmlsZW5hbWVDb3B5KTtcclxuICAgICAgICB0RmlsZSA9IGFwcC5tZXRhZGF0YUNhY2hlLmdldEZpcnN0TGlua3BhdGhEZXN0KGZpbGVuYW1lQ29weSwgcGF0aCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4geyBmaWxlTmFtZTogZmlsZW5hbWVDb3B5LCB0RmlsZSB9O1xyXG59XHJcblxyXG4vKipcclxuICogVHJpZXMgdG8gY29udmVydCBmaWxlIG5hbWUgdG8gT2JzaWRpYW4gU3R1ZHkgS2l0IGZpbGUgbmFtZVxyXG4gKiBAcGFyYW0gYm9va0FuZENoYXB0ZXIgRmlsZSBuYW1lIHRoYXQgc2hvdWxkIGJlIGNvbnZlcnRlZFxyXG4gKiBAcmV0dXJucyBmaWxlIG5hbWUgaW4gT2JzaWRhaW4gU3R1ZHkgS2l0IG5hbWluZyBzeXN0ZW1cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiB0cnlDb252ZXJ0VG9PQlNLRmlsZU5hbWUoYm9va0FuZENoYXB0ZXI6IHN0cmluZykge1xyXG4gICAgaWYgKGJvb2tBbmRDaGFwdGVyUmVnZXhGb3JPQlNLLnRlc3QoYm9va0FuZENoYXB0ZXIpKSB7IC8vIFZhbGlkIGNoYXB0ZXIgbmFtZVxyXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBwcmVmZXItY29uc3RcclxuICAgICAgICBsZXQgWywgYm9vaywgbnVtYmVyXSA9IGJvb2tBbmRDaGFwdGVyLm1hdGNoKGJvb2tBbmRDaGFwdGVyUmVnZXhGb3JPQlNLKTtcclxuICAgICAgICBpZiAobnVtYmVyLmxlbmd0aCA9PSAxKSB7XHJcbiAgICAgICAgICAgIG51bWJlciA9IGAwJHtudW1iZXJ9YFxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gYCR7Ym9va30tJHtudW1iZXJ9YFxyXG4gICAgfVxyXG59XHJcbiIsICJcclxuaW1wb3J0IHsgQXBwLCBNb2RhbCwgU2V0dGluZyB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgeyBQbHVnaW5TZXR0aW5ncyB9IGZyb20gXCIuLi9tYWluXCI7XHJcbmltcG9ydCB7IGNyZWF0ZUxpbmtzIH0gZnJvbSBcIi4uL2xvZ2ljL2xpbmstY29tbWFuZFwiO1xyXG5cclxuZXhwb3J0IGVudW0gTGlua1R5cGUge1xyXG4gICAgQmFzaWMgPSBcIkJhc2ljXCIsXHJcbiAgICBFbWJlZGRlZCA9IFwiRW1iZWRkZWRcIixcclxuICAgIEludmlzaWJsZSA9IFwiSW52aXNpYmxlXCIsXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBNb2RhbCB0aGF0IGxldHMgeW91IGluc2VydCBiaWJsZSByZWZlcmVuY2UgYnkgdXNpbmcgT2JzaWRpYW4gbGlua3MgXHJcbiAqL1xyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBMaW5rVmVyc2VNb2RhbCBleHRlbmRzIE1vZGFsIHtcclxuICAgIHVzZXJJbnB1dDogc3RyaW5nO1xyXG4gICAgbGlua1R5cGU6IExpbmtUeXBlO1xyXG4gICAgdXNlTmV3TGluZTogYm9vbGVhbjtcclxuICAgIG9uU3VibWl0OiAocmVzdWx0OiBzdHJpbmcpID0+IHZvaWQ7XHJcbiAgICBwbHVnaW5TZXR0aW5nczogUGx1Z2luU2V0dGluZ3M7XHJcblxyXG4gICAgaGFuZGxlSW5wdXQgPSBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgY3JlYXRlTGlua3ModGhpcy5hcHAsIHRoaXMudXNlcklucHV0LCB0aGlzLmxpbmtUeXBlLCB0aGlzLnVzZU5ld0xpbmUsIHRoaXMucGx1Z2luU2V0dGluZ3MpXHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICAgICAgdGhpcy5vblN1Ym1pdChyZXMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgc2V0dGluZ3M6IFBsdWdpblNldHRpbmdzLCBvblN1Ym1pdDogKHJlc3VsdDogc3RyaW5nKSA9PiB2b2lkKSB7XHJcbiAgICAgICAgc3VwZXIoYXBwKTtcclxuICAgICAgICB0aGlzLm9uU3VibWl0ID0gb25TdWJtaXQ7XHJcbiAgICAgICAgdGhpcy5wbHVnaW5TZXR0aW5ncyA9IHNldHRpbmdzO1xyXG4gICAgICAgIHRoaXMubGlua1R5cGUgPSB0aGlzLnBsdWdpblNldHRpbmdzLmxpbmtUeXBlUHJlc2V0O1xyXG4gICAgICAgIHRoaXMudXNlTmV3TGluZSA9IHRoaXMucGx1Z2luU2V0dGluZ3MubmV3TGluZVByZXNldDtcclxuICAgIH1cclxuXHJcbiAgICBvbk9wZW4oKSB7XHJcbiAgICAgICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XHJcblxyXG4gICAgICAgIC8vIEFkZCBoZWFkaW5nIFxyXG4gICAgICAgIGNvbnRlbnRFbC5jcmVhdGVFbChcImgzXCIsIHsgdGV4dDogXCJDcmVhdGUgT2JzaWRpYW4gbGlua3MgZnJvbSBCaWJsZSByZWZlcmVuY2VcIiB9KTtcclxuXHJcbiAgICAgICAgLy8gQWRkIFRleHRib3ggZm9yIHJlZmVyZW5jZVxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoXCJJbnNlcnQgcmVmZXJlbmNlXCIpXHJcbiAgICAgICAgICAgIC5hZGRUZXh0KCh0ZXh0KSA9PiB0ZXh0Lm9uQ2hhbmdlKCh2YWx1ZSkgPT4geyB0aGlzLnVzZXJJbnB1dCA9IHZhbHVlIH0pXHJcbiAgICAgICAgICAgICAgICAuaW5wdXRFbC5mb2N1cygpKTsgLy8gU2V0cyBmb2N1cyB0byBpbnB1dCBmaWVsZFxyXG5cclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGVudEVsKVxyXG4gICAgICAgICAgICAuc2V0TmFtZShcIkxpbmsgdHlwZVwiKVxyXG4gICAgICAgICAgICAuYWRkRHJvcGRvd24oKGRyb3Bkb3duKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24oTGlua1R5cGUuQmFzaWMsIExpbmtUeXBlLkJhc2ljKVxyXG4gICAgICAgICAgICAgICAgZHJvcGRvd24uYWRkT3B0aW9uKExpbmtUeXBlLkVtYmVkZGVkLCBMaW5rVHlwZS5FbWJlZGRlZClcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbihMaW5rVHlwZS5JbnZpc2libGUsIExpbmtUeXBlLkludmlzaWJsZSlcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLm9uQ2hhbmdlKCh2YWx1ZSkgPT4gdGhpcy5saW5rVHlwZSA9IHZhbHVlIGFzIExpbmtUeXBlKVxyXG4gICAgICAgICAgICAgICAgZHJvcGRvd24uc2V0VmFsdWUodGhpcy5wbHVnaW5TZXR0aW5ncy5saW5rVHlwZVByZXNldClcclxuICAgICAgICAgICAgfSlcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGVudEVsKVxyXG4gICAgICAgICAgICAuc2V0TmFtZShcIkVhY2ggbGluayBvbiBuZXcgbGluZT9cIilcclxuICAgICAgICAgICAgLmFkZFRvZ2dsZSgodGdsKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0Z2wuc2V0VmFsdWUodGhpcy5wbHVnaW5TZXR0aW5ncy5uZXdMaW5lUHJlc2V0KVxyXG4gICAgICAgICAgICAgICAgdGdsLm9uQ2hhbmdlKHZhbCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51c2VOZXdMaW5lID0gdmFsO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKVxyXG5cclxuXHJcbiAgICAgICAgLy8gQWRkIGJ1dHRvbiBmb3Igc3VibWl0L2V4aXRcclxuICAgICAgICBuZXcgU2V0dGluZyhjb250ZW50RWwpXHJcbiAgICAgICAgICAgIC5hZGRCdXR0b24oKGJ0bikgPT4ge1xyXG4gICAgICAgICAgICAgICAgYnRuXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoXCJMaW5rXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldEN0YSgpXHJcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2xpY2sodGhpcy5oYW5kbGVJbnB1dClcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIEFsbG93IHVzZXIgdG8gZXhpdCB1c2luZyBFbnRlciBrZXlcclxuICAgICAgICBjb250ZW50RWwub25rZXlkb3duID0gKGV2ZW50KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChldmVudC5rZXkgPT09IFwiRW50ZXJcIikge1xyXG4gICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlSW5wdXQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBvbkNsb3NlKCkge1xyXG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xyXG4gICAgICAgIGNvbnRlbnRFbC5lbXB0eSgpO1xyXG4gICAgfVxyXG59XHJcblxyXG4iLCAiaW1wb3J0IHtBcHAsIE5vdGljZX0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCB7TGlua1R5cGV9IGZyb20gXCIuLi9tb2RhbHMvbGluay12ZXJzZS1tb2RhbFwiO1xyXG5pbXBvcnQge1BsdWdpblNldHRpbmdzfSBmcm9tIFwiLi4vbWFpblwiO1xyXG5pbXBvcnQge211bHRpcGxlQ2hhcHRlcnN9IGZyb20gXCIuLi91dGlscy9yZWdleGVzXCI7XHJcbmltcG9ydCB7Y2FwaXRhbGl6ZSwgZ2V0RmlsZUJ5RmlsZW5hbWUsIHBhcnNlVXNlckJvb2tJbnB1dCwgcGFyc2VVc2VyVmVyc2VJbnB1dH0gZnJvbSBcIi4vY29tbW9uXCI7XHJcblxyXG4vKipcclxuICogQ29udmVydHMgYmlibGljYWwgcmVmZXJlbmNlIHRvIGxpbmtzIHRvIGdpdmVuIHZlcnNlcyBvciBib29rc1xyXG4gKiBAcGFyYW0gYXBwIEFwcCBpbnN0YW5jZVxyXG4gKiBAcGFyYW0gdXNlcklucHV0IFVzZXIgSW5wdXQgKGxpbmsgdG8gdmVyc2Ugb3IgY2hhcHRlcilcclxuICogQHBhcmFtIGxpbmtUeXBlIFR5cGUgb2YgbGluayB0aGF0IHNob3VsZCBiZSB1c2VkXHJcbiAqIEBwYXJhbSB1c2VOZXdMaW5lIFdoZXRoZXIgb3Igbm90IHNob3VsZCBlYWNoIGxpbmsgYmUgb24gbmV3IGxpbmVcclxuICogQHJldHVybnMgU3RyaW5nIHdpdGggcXVvdGUgb2YgbGlua2VkIHZlcnNlcy4gSWYgY29udmVydGluZyB3YXMgbm90IHN1Y2Nlc3NmdWwsIHJldHVybnMgZW1wdHkgc3RyaW5nLlxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUxpbmtzKGFwcDogQXBwLCB1c2VySW5wdXQ6IHN0cmluZywgbGlua1R5cGU6IExpbmtUeXBlLCB1c2VOZXdMaW5lOiBib29sZWFuLCBzZXR0aW5nczogUGx1Z2luU2V0dGluZ3MpIHtcclxuXHRpZiAobXVsdGlwbGVDaGFwdGVycy50ZXN0KHVzZXJJbnB1dCkpIHtcclxuXHRcdHJldHVybiBnZXRMaW5rc0ZvckNoYXB0ZXJzKGFwcCwgdXNlcklucHV0LCBsaW5rVHlwZSwgdXNlTmV3TGluZSwgc2V0dGluZ3MpO1xyXG5cdH0gZWxzZSB7XHJcblx0XHRyZXR1cm4gZ2V0TGlua3NGb3JWZXJzZXMoYXBwLCB1c2VySW5wdXQsIGxpbmtUeXBlLCB1c2VOZXdMaW5lLCBzZXR0aW5ncyk7XHJcblx0fVxyXG59XHJcblxyXG4vKipcclxuICogQ3JlYXRlcyBjb3B5IGNvbW1hbmQgb3V0cHV0IHdoZW4gbGlua2luZyBtdWx0aXBsZSB2ZXJzZXNcclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIGdldExpbmtzRm9yVmVyc2VzKGFwcDogQXBwLCB1c2VySW5wdXQ6IHN0cmluZywgbGlua1R5cGU6IExpbmtUeXBlLCB1c2VOZXdMaW5lOiBib29sZWFuLCBzZXR0aW5nczogUGx1Z2luU2V0dGluZ3MpIHtcclxuXHQvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcHJlZmVyLWNvbnN0XHJcblx0bGV0IHtib29rQW5kQ2hhcHRlciwgYmVnaW5WZXJzZSwgZW5kVmVyc2V9ID0gcGFyc2VVc2VyVmVyc2VJbnB1dCh1c2VySW5wdXQpO1xyXG5cdGJvb2tBbmRDaGFwdGVyID0gY2FwaXRhbGl6ZShib29rQW5kQ2hhcHRlcikgLy8gRm9yIG91dHB1dCBjb25zaXN0ZW5jeVxyXG5cdGlmIChzZXR0aW5ncy52ZXJpZnlGaWxlc1doZW5MaW5raW5nKSB7XHJcblx0XHRjb25zdCB7ZmlsZU5hbWUsIHRGaWxlfSA9IGdldEZpbGVCeUZpbGVuYW1lKGFwcCwgYm9va0FuZENoYXB0ZXIpO1xyXG5cdFx0aWYgKCF0RmlsZSkge1xyXG5cdFx0XHRuZXcgTm90aWNlKGBGaWxlIFwiJHtmaWxlTmFtZX1cIiBkb2VzIG5vdCBleGlzdCBhbmQgdmVyaWZ5IGZpbGVzIGlzIHNldCB0byB0cnVlYCk7XHJcblx0XHRcdHRocm93IGBGaWxlICR7ZmlsZU5hbWV9IGRvZXMgbm90IGV4aXN0LCB2ZXJpZnkgZmlsZXMgPSB0cnVlYDtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGlmIChiZWdpblZlcnNlID4gZW5kVmVyc2UpIHtcclxuXHRcdG5ldyBOb3RpY2UoXCJCZWdpbiB2ZXJzZSBpcyBiaWdnZXIgdGhhbiBlbmQgdmVyc2VcIilcclxuXHRcdHRocm93IFwiQmVnaW4gdmVyc2UgaXMgYmlnZ2VyIHRoYW4gZW5kIHZlcnNlXCJcclxuXHR9XHJcblxyXG5cdGxldCByZXMgPSBcIlwiO1xyXG5cdGNvbnN0IGJlZ2lubmluZyA9IGxpbmtUeXBlID09PSBMaW5rVHlwZS5FbWJlZGRlZCA/IFwiIVwiIDogXCJcIjtcclxuXHRjb25zdCBlbmRpbmcgPSBsaW5rVHlwZSA9PT0gTGlua1R5cGUuSW52aXNpYmxlID8gXCJ8XCIgOiBcIlwiO1xyXG5cdGZvciAobGV0IGkgPSBiZWdpblZlcnNlOyBpIDw9IGVuZFZlcnNlOyBpKyspIHtcclxuXHRcdHJlcyArPSBgJHtiZWdpbm5pbmd9W1ske2Jvb2tBbmRDaGFwdGVyfSR7c2V0dGluZ3MubGlua1NlcGFyYXRvcn0ke3NldHRpbmdzLnZlcnNlUHJlZml4fSR7aX0ke2VuZGluZ31dXWBcclxuXHRcdGlmICh1c2VOZXdMaW5lKSB7XHJcblx0XHRcdHJlcyArPSAnXFxuJ1xyXG5cdFx0fVxyXG5cdH1cclxuXHRyZXR1cm4gcmVzO1xyXG59XHJcblxyXG4vKipcclxuICogQ3JlYXRlcyBjb3B5IGNvbW1hbmQgb3V0cHV0IHdoZW4gbGlua2luZyBtdWx0aXBsZSBjaGFwdGVyc1xyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gZ2V0TGlua3NGb3JDaGFwdGVycyhhcHA6IEFwcCwgdXNlcklucHV0OiBzdHJpbmcsIGxpbmtUeXBlOiBMaW5rVHlwZSwgdXNlTmV3TGluZTogYm9vbGVhbiwgc2V0dGluZ3M6IFBsdWdpblNldHRpbmdzKSB7XHJcblx0Y29uc3Qge2Jvb2ssIGZpcnN0Q2hhcHRlciwgbGFzdENoYXB0ZXJ9ID0gcGFyc2VVc2VyQm9va0lucHV0KHVzZXJJbnB1dCk7XHJcblx0aWYgKGZpcnN0Q2hhcHRlciA+IGxhc3RDaGFwdGVyKSB7XHJcblx0XHRuZXcgTm90aWNlKFwiQmVnaW4gY2hhcHRlciBpcyBiaWdnZXIgdGhhbiBlbmQgY2hhcHRlclwiKVxyXG5cdFx0dGhyb3cgXCJCZWdpbiBjaGFwdGVyIGlzIGJpZ2dlciB0aGFuIGVuZCBjaGFwdGVyXCJcclxuXHR9XHJcblxyXG5cdGxldCByZXMgPSBcIlwiO1xyXG5cdGZvciAobGV0IGkgPSBmaXJzdENoYXB0ZXI7IGkgPD0gbGFzdENoYXB0ZXI7IGkrKykge1xyXG5cdFx0cmVzICs9IGBbWyR7Ym9va30gJHtpfV1dYFxyXG5cdFx0aWYgKHVzZU5ld0xpbmUpIHtcclxuXHRcdFx0cmVzICs9ICdcXG4nXHJcblx0XHR9XHJcblx0fVxyXG5cdHJldHVybiByZXM7XHJcbn1cclxuIiwgImltcG9ydCB7IEFwcCwgTm90aWNlLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCBCaWJsZUxpbmtlclBsdWdpbiBmcm9tIFwiLi9tYWluXCI7XHJcbmltcG9ydCB7IExpbmtUeXBlIH0gZnJvbSBcIi4vbW9kYWxzL2xpbmstdmVyc2UtbW9kYWxcIjtcclxuaW1wb3J0IHsgTGlua1R5cGUgYXMgQ29weUxpbmtUeXBlIH0gZnJvbSBcIi4vbW9kYWxzL2NvcHktdmVyc2UtbW9kYWxcIjtcclxuXHJcbi8qKlxyXG4gKiBTZXR0aW5ncyBmb3IgcGx1Z2luXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgU2V0dGluZ3NUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcclxuICAgIHBsdWdpbjogQmlibGVMaW5rZXJQbHVnaW47XHJcblxyXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogQmlibGVMaW5rZXJQbHVnaW4pIHtcclxuICAgICAgICBzdXBlcihhcHAsIHBsdWdpbik7XHJcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XHJcbiAgICB9XHJcblxyXG4gICAgZGlzcGxheSgpIHtcclxuICAgICAgICBjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xyXG5cclxuICAgICAgICBjb250YWluZXJFbC5lbXB0eSgpO1xyXG5cclxuICAgICAgICBjb250YWluZXJFbC5jcmVhdGVFbChcImgyXCIsIHsgdGV4dDogXCJDb3B5IGFuZCBMaW5rIEJpYmxlIHZlcnNlcyBjb21tYW5kXCIgfSk7XHJcbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoXCJoNFwiLCB7IHRleHQ6IFwiRnVuY3Rpb25hbFwiIH0pO1xyXG5cclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoXCJWZXJzZSBvZmZzZXRcIilcclxuICAgICAgICAgICAgLnNldERlc2MoJ0NoYW5nZSB0aGlzIGlmIHdyb25nIHZlcnNlcyBhcmUgYmVpbmcgbGlua2VkLCBlLmcuIHlvdSB3YW50IFwiR2VuIDEsMS0zXCIgYnV0IG91dHB1dCBpcyB0ZXh0IGZyb20gdmVyc2VzIDItNCBcdTIxOTIgc2V0IHRoaXMgdG8gLTEnKVxyXG4gICAgICAgICAgICAuc2V0Q2xhc3MoXCJpbXBvcnRhbnQtc2V0dGluZ1wiKVxyXG4gICAgICAgICAgICAuYWRkVGV4dCgoaW5wdXRCb3gpID0+XHJcbiAgICAgICAgICAgICAgICBpbnB1dEJveFxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy52ZXJzZU9mZnNldC50b1N0cmluZygpKVxyXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbnVtYmVyID0gTnVtYmVyLnBhcnNlSW50KHZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlID09PSBcIi1cIikgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoTnVtYmVyLmlzTmFOKG51bWJlcikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoXCJJbnZhbGlkIGlucHV0LCBwbGVhc2UgaW5zZXJ0IHZhbGlkIGludGVnZXJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnB1dEJveC5zZXRWYWx1ZShcIlwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy52ZXJzZU9mZnNldCA9IG51bWJlcjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgKVxyXG5cclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoXCJWZXJzZSBoZWFkaW5nIGxldmVsXCIpXHJcbiAgICAgICAgICAgIC5zZXREZXNjKCdJZiBzZXQsIG9ubHkgaGVhZGluZ3Mgb2Ygc3BlY2lmaWVkIGxldmVsIGFyZSBjb25zaWRlcmVkIHZlcnNlcyAoaWYgZmlyc3QgaGVhZGluZyBvZiB0aGlzIGxldmVsIGlzIGFsd2F5cyBhIHZlcnNlLCBhbHNvIHNldCBcIlZlcnNlIG9mZnNldFwiIHRvIC0xKScpXHJcbiAgICAgICAgICAgIC5hZGREcm9wZG93bigoZHJvcGRvd24pID0+IHtcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbihcImFueVwiLCBcImFueVwiKVxyXG4gICAgICAgICAgICAgICAgZHJvcGRvd24uYWRkT3B0aW9uKFwiNlwiLCBcIiMjIyMjI1wiKVxyXG4gICAgICAgICAgICAgICAgZHJvcGRvd24uYWRkT3B0aW9uKFwiNVwiLCBcIiMjIyMjXCIpXHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24oXCI0XCIsIFwiIyMjI1wiKVxyXG4gICAgICAgICAgICAgICAgZHJvcGRvd24uYWRkT3B0aW9uKFwiM1wiLCBcIiMjI1wiKVxyXG4gICAgICAgICAgICAgICAgZHJvcGRvd24uYWRkT3B0aW9uKFwiMlwiLCBcIiMjXCIpXHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24oXCIxXCIsIFwiI1wiKVxyXG4gICAgICAgICAgICAgICAgZHJvcGRvd24uc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MudmVyc2VIZWFkaW5nTGV2ZWw/LnRvU3RyaW5nKCkgPz8gXCJhbnlcIilcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnZlcnNlSGVhZGluZ0xldmVsID0gdmFsdWUgPT09IFwiYW55XCIgPyB1bmRlZmluZWQgOiBOdW1iZXIodmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfSlcclxuXHJcbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoXCJoNFwiLCB7IHRleHQ6IFwiSW5zZXJ0ZWQgcHJlZml4ZXMvcG9zdGZpeGVzXCIgfSk7XHJcblxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAuc2V0TmFtZShcIkxpbmUgcHJlZml4XCIpXHJcbiAgICAgICAgICAgIC5zZXREZXNjKFwiU3RyaW5nIGluc2VydGVkIGluIGZyb250IG9mIGV2ZXJ5IGxpbmUsIGZvciBleGFtcGxlICc+JyBmb3IgcXVvdGUuIE5vdGU6IElmIHlvdSBzZXQgJ1B1dCBlYWNoIHZlcnNlIG9uIGEgbmV3IGxpbmU/JyB0byB0cnVlLCB0aGUgcHJlZml4IHdpbGwgYmUgaW5zZXJ0ZWQgaW4gZnJvbnQgb2YgZXZlcnkgbGluZS5cIilcclxuICAgICAgICAgICAgLnNldENsYXNzKFwiaW1wb3J0YW50LXNldHRpbmdcIilcclxuICAgICAgICAgICAgLmFkZFRleHQoKGlucHV0Qm94KSA9PlxyXG4gICAgICAgICAgICAgICAgaW5wdXRCb3hcclxuICAgICAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoXCJJbnNlcnQgcHJlZml4IGhlcmVcIilcclxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MucHJlZml4KVxyXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJlZml4ID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIClcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKFwiTGluayBwb3N0Zml4XCIpXHJcbiAgICAgICAgICAgIC5zZXREZXNjKFwiU3RyaW5nIGluc2VydGVkIGFmdGVyIGJpYmxpY2FsIGxpbmssIHlvdSBjYW4gdXNlIFxcXFxuIHRvIGluc2VydCBuZXdsaW5lLlwiKVxyXG4gICAgICAgICAgICAuYWRkVGV4dCgoaW5wdXRCb3gpID0+XHJcbiAgICAgICAgICAgICAgICBpbnB1dEJveFxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcihcIkluc2VydCBwb3N0Zml4IGhlcmVcIilcclxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MucG9zdGZpeClcclxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnBvc3RmaXggPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgKVxyXG5cclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoXCJFYWNoIHZlcnNlIHByZWZpeFwiKVxyXG4gICAgICAgICAgICAuc2V0RGVzYyhcIlN0cmluZyBpbnNlcnRlZCBpbiBmcm9udCBvZiBldmVyeSBjb3BpZWQgdmVyc2UuIFlvdSBjYW4gdXNlIFxcXCJ7bn1cXFwiIHdoZXJlIHlvdSB3YW50IG51bWJlciBvZiBnaXZlbiB2ZXJzZSBpbnNlcnRlZCwgZm9yIGV4YW1wbGUgXFxcIioqe259KiogXFxcIiB3aWxsIG1ha2UgZWFjaCB2ZXJzZSBzdGFydCB3aXRoIGJvbGQgdmVyc2UgbnVtYmVyLiBZb3UgY2FuIGFsc28gdXNlIFxcXCJ7Zn1cXFwiIHRvIGluc2VydCBuYW1lIG9mIHRoZSBjb3JyZXNwb25kaW5nIGZpbGUgKGZvciBleGFtcGxlIHRvIGNyZWF0ZSBvYnNpZGlhbiBsaW5rcykuIExlYXZlIGVtcHR5IGZvciBubyBwcmVmaXguXCIpXHJcbiAgICAgICAgICAgIC5hZGRUZXh0KChpbnB1dEJveCkgPT5cclxuICAgICAgICAgICAgICAgIGlucHV0Qm94XHJcbiAgICAgICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKFwiSW5zZXJ0IHByZWZpeCBoZXJlXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmVhY2hWZXJzZVByZWZpeClcclxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmVhY2hWZXJzZVByZWZpeCA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICApXHJcblxyXG5cclxuICAgICAgICBjb250YWluZXJFbC5jcmVhdGVFbChcImg0XCIsIHsgdGV4dDogXCJMaW5rc1wiIH0pO1xyXG5cclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoXCJMaW5rIHRvIGxhc3QgdmVyc2U/XCIpXHJcbiAgICAgICAgICAgIC5zZXREZXNjKFwiU2hvdWxkIGxhc3QgdmVyc2UgYmUgbGlua2VkIGluIHRoZSB2aXNpYmxlIGxpbmsgYmVmb3JlIHRleHQgb2YgdmVyc2VzP1wiKVxyXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcbiAgICAgICAgICAgICAgICB0b2dnbGVcclxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubGlua0VuZFZlcnNlKVxyXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MubGlua0VuZFZlcnNlID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIClcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKFwiQWRkIGludmlzaWJsZSBsaW5rcz9cIilcclxuICAgICAgICAgICAgLnNldERlc2MoXCJJbnZpc2libGUgbGlua3MgYXJlIGFkZGVkIHRvIGVhY2ggdmVyc2UgdXNlZCAoc28geW91IGNhbiBmaW5kIHRoZSBjb25uZWN0aW9ucyBsYXRlciksIHRoZXkgYXJlIG9ubHkgdmlzaWJsZSBpbiBzb3VyY2UgbW9kZS5cIilcclxuICAgICAgICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG4gICAgICAgICAgICAgICAgdG9nZ2xlXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnVzZUludmlzaWJsZUxpbmtzKVxyXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MudXNlSW52aXNpYmxlTGlua3MgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgKVxyXG5cclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoXCJMaW5rIG9ubHkgZGVmYXVsdFwiKVxyXG4gICAgICAgICAgICAuc2V0RGVzYyhcIldoYXQgdGhlIGxpbmsgb25seSBvcHRpb24gc2hvdWxkIGJlIHNldCB0byBieSBkZWZhdWx0XCIpXHJcbiAgICAgICAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cclxuICAgICAgICAgICAgICAgIHRvZ2dsZVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5saW5rT25seSlcclxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmxpbmtPbmx5ID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIClcclxuXHJcblxyXG4gICAgICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKFwiaDRcIiwgeyB0ZXh0OiBcIk91dHB1dCBmb3JtYXRcIiB9KTtcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKFwiUHV0IGVhY2ggdmVyc2Ugb24gYSBuZXcgbGluZT9cIilcclxuICAgICAgICAgICAgLnNldERlc2MoXCJFYWNoIHZlcnNlIGlzIGluc2VydGVkIG9uIGEgbmV3IGxpbmUgKHdpdGggTGluayBwcmVmaXgpLlwiKVxyXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcbiAgICAgICAgICAgICAgICB0b2dnbGVcclxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubmV3TGluZXMpXHJcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5uZXdMaW5lcyA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICApXHJcblxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAuc2V0TmFtZShcIkluc2VydCBzcGFjZSBiZXR3ZWVuIHZlcnNlcz9cIilcclxuICAgICAgICAgICAgLnNldERlc2MoXCJTaG91bGQgc3BhY2UgYmUgaW5zZXJ0ZWQgYmV0d2VlbiB2ZXJzZXM/IChPbmx5IGFwcGxpZWQgd2hlbiBQdXQgZWFjaCB2ZXJzZSBvbiBhIG5ldyBsaW5lPyBpcyBzZSB0byBmYWxzZS4gVXNlZnVsIGZvciBsYW5ndWFnZXMgc3VjaCBhcyBDaGluZXNlLilcIilcclxuICAgICAgICAgICAgLnNldERpc2FibGVkKCF0aGlzLnBsdWdpbi5zZXR0aW5ncy5uZXdMaW5lcylcclxuICAgICAgICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG4gICAgICAgICAgICAgICAgdG9nZ2xlXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmluc2VydFNwYWNlKVxyXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuaW5zZXJ0U3BhY2UgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgKVxyXG5cclxuXHJcbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoXCJoNFwiLCB7IHRleHQ6IFwiTm90YXRpb25cIiB9KTtcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKFwiT25lIHZlcnNlIG5vdGF0aW9uXCIpXHJcbiAgICAgICAgICAgIC5zZXREZXNjKFwiVGhpcyBpcyB0aGUgc3ltYm9sIHRoYXQgd2lsbCBiZSB1c2VkIGJldHdlZW4gY2hhcHRlciBudW1iZXIgYW5kIHZlcnNlIG51bWJlciB3aGVuIGNvcHlpbmcgb25lIHZlcnNlLiBGb3IgZXhhbXBsZSBcXFwiLlxcXCIgXHUyMTkyIEdlbiAxLjEuXCIpXHJcbiAgICAgICAgICAgIC5hZGRUZXh0KChpbnB1dEJveCkgPT5cclxuICAgICAgICAgICAgICAgIGlucHV0Qm94XHJcbiAgICAgICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKFwiSW5zZXJ0IG5vdGF0aW9uIHN5bWJvbCBoZXJlXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm9uZVZlcnNlTm90YXRpb24pXHJcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5vbmVWZXJzZU5vdGF0aW9uID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIClcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKFwiTXVsdGlwbGUgdmVyc2VzIG5vdGF0aW9uXCIpXHJcbiAgICAgICAgICAgIC5zZXREZXNjKFwiVGhpcyBpcyB0aGUgc3ltYm9sIHRoYXQgd2lsbCBiZSB1c2VkIGJldHdlZW4gY2hhcHRlciBudW1iZXIgYW5kIHZlcnNlIG51bWJlciB3aGVuIGNvcHlpbmcgbXVsdGlwbGUgdmVyc2VzLiBGb3IgZXhhbXBsZSBcXFwiLFxcXCIgXHUyMTkyIEdlbiAxLDEtMy5cIilcclxuICAgICAgICAgICAgLmFkZFRleHQoKGlucHV0Qm94KSA9PlxyXG4gICAgICAgICAgICAgICAgaW5wdXRCb3hcclxuICAgICAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoXCJJbnNlcnQgbm90YXRpb24gc3ltYm9sIGhlcmVcIilcclxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubXVsdGlwbGVWZXJzZXNOb3RhdGlvbilcclxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLm11bHRpcGxlVmVyc2VzTm90YXRpb24gPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgKVxyXG5cclxuICAgICAgICBjb250YWluZXJFbC5jcmVhdGVFbChcImg0XCIsIHsgdGV4dDogXCJNdWx0aXBsZSB0cmFuc2xhdGlvbnNcIiB9KTtcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKFwiRW5hYmxlIG11bHRpcGxlIHRyYW5zbGF0aW9uc1wiKVxyXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcbiAgICAgICAgICAgICAgICB0b2dnbGVcclxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlTXVsdGlwbGVUcmFuc2xhdGlvbnMpXHJcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVNdWx0aXBsZVRyYW5zbGF0aW9ucyA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwbGF5KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgKVxyXG5cclxuXHJcbiAgICAgICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZU11bHRpcGxlVHJhbnNsYXRpb25zKSB7XHJcbiAgICAgICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAgICAgLnNldE5hbWUoXCJQYXRocyB0byB0cmFuc2xhdGlvbnMgd2l0aCB0aGVpciBuYW1lc1wiKVxyXG4gICAgICAgICAgICAgICAgLnNldERlc2MoXCJJbnB1dCBmdWxsIHBhdGhzIGZyb20gdGhlIHJvb3QgdmFsdXQgZm9sZGVyIHRvIGZvbGRlcnMgY29udGFpbmluZyBCaWJsZSB0cmFuc2xhdGlvbnMsIGVhY2ggdHJuYXNsYXRpb24gb24gc2VwYXJhdGUgbGluZS4gQW4gZXhhbXBsZSBvZiBvbmUgZW50cnk6IFxcXCJCaWJsZS9OSVYvXFxcIi4gVGhlIHBsdWdpbiB3aWxsIHNlYXJjaCBmb3IgY29ycmVzcG9uZGluZyBCaWJsZSBmaWxlcyB1c2luZyBnaXZlbiBwYXRocyBhcyBzdGFydGluZyBwb2ludHMuIE1ha2Ugc3VyZSB0aGVyZSBhcmUgbm8gZHVwbGljYXRlIGZpbGVzIGluIGdpdmVuIHBhdGhzLCBvdGhlcndpc2UgaXQgaXMgaGFyZCB0byB0ZWxsIHdoYXQgdGhlIG91dHB1dCB3aWxsIGJlLiBUaGUgZmlyc3QgdHJhbnNsYXRpb24gd2lsbCBiZSBjb25zaWRlcmVkIHlvdXIgbWFpbiB0cmFuc2xhdGlvbi5cIikuYWRkVGV4dEFyZWEoKGlucHV0Qm94KSA9PlxyXG4gICAgICAgICAgICAgICAgICAgIGlucHV0Qm94XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcihcIkJpYmxlL05JVi9cXG5CaWJsZS9FU1YvXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy50cmFuc2xhdGlvbnNQYXRocylcclxuICAgICAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaW5wdXRQYXRocyA9IHZhbHVlLnNwbGl0KC9cXHI/XFxufFxcci8pOyAvLyBzcGxpdCB1c2VyIGlucHV0IGJ5IGxpbmVzIChyZWdleCB0YWtlcyBpbnRvIGFjY291bnQgYWxsIHBvc3NpYmxlIGxpbmUgZW5kaW5ncylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhdGhzOiBzdHJpbmdbXSA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXRQYXRocy5mb3JFYWNoKChwYXRoKSA9PiB7IC8vIHBhcnNlIHVzZXIgaW5wdXQgZm9yIGxhdGVyIHVzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXRoLmF0KC0xKSAhPT0gXCIvXCIpIHsgLy8gQWRkIHBvdGVudGlvbmFsbHkgbWlzc2luZyAnLycgdG8gcGF0aFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRocy5wdXNoKHBhdGggKyBcIi9cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRocy5wdXNoKHBhdGgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnRyYW5zbGF0aW9uc1BhdGhzID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wYXJzZWRUcmFuc2xhdGlvblBhdGhzID0gcGF0aHM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIClcclxuXHJcblxyXG4gICAgICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAgICAgICAgIC5zZXROYW1lKFwiV2hhdCB0byBsaW5rXCIpXHJcbiAgICAgICAgICAgICAgICAuc2V0RGVzYyhcIkNob29zZSB3aGF0IHRyYW5zbGF0aW9ucyBzaG91bGQgYmUgbGlua2VkIHdoZW4gY29weWluZyBhIHZlcnNlLlwiKVxyXG4gICAgICAgICAgICAgICAgLmFkZERyb3Bkb3duKChkcm9wZG93bikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbihcImFsbFwiLCBcIkxpbmsgdG8gYWxsIHRyYW5zbGF0aW9uc1wiKVxyXG4gICAgICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbihcInVzZWRcIiwgXCJMaW5rIG9ubHkgdG8gdXNlZCB0cmFuc2xhdGlvblwiKVxyXG4gICAgICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbihcInVzZWRBbmRNYWluXCIsIFwiTGluayB0byB1c2VkIGFuZCBtYWluIHRyYW5zbGF0aW9uXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgZHJvcGRvd24uYWRkT3B0aW9uKFwibWFpblwiLCBcIkxpbmsgb25seSB0byBtYWluIHRyYW5zbGF0aW9uXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgZHJvcGRvd24uc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MudHJhbnNsYXRpb25MaW5raW5nVHlwZSlcclxuICAgICAgICAgICAgICAgICAgICBkcm9wZG93bi5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MudHJhbnNsYXRpb25MaW5raW5nVHlwZSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICAvLyBMSU5LIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoXCJoMlwiLCB7IHRleHQ6IFwiTGluayBCaWJsZSB2ZXJzZXMgY29tbWFuZFwiIH0pO1xyXG5cclxuICAgICAgICBjb250YWluZXJFbC5jcmVhdGVFbChcImg0XCIsIHsgdGV4dDogXCJGaWxlIGZvcm1hdFwiIH0pO1xyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAuc2V0TmFtZShcIkxpbmsgc2VwYXJhdG9yXCIpXHJcbiAgICAgICAgICAgIC5zZXREZXNjKFwiVGhpcyBpcyB0aGUgc2VwYXJhdG9yIHRoYXQgd2lsbCBiZSB1c2VkIHdoZW4gbGlua2luZywgZS5nLiBpZiB5b3UgZW50ZXIgJyMnIGhlcmUsIG91dHB1dCB3aWxsIGJlIFtbR2VuIDEjMV1dLiBJZiB5b3UgYXJlIHVzaW5nIGhlYWRpbmdzIHRvIG1hcmsgdmVyc2VzLCB1c2UgJyMnLiBJZiB5b3UgYXJlIHVzaW5nIGJsb2NrIHJlZmVyZW5jZXMsIHVzZSAnXicuXCIpXHJcbiAgICAgICAgICAgIC5zZXRDbGFzcyhcImltcG9ydGFudC1zZXR0aW5nXCIpXHJcbiAgICAgICAgICAgIC5hZGRUZXh0KChpbnB1dEJveCkgPT5cclxuICAgICAgICAgICAgICAgIGlucHV0Qm94XHJcbiAgICAgICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKFwiSW5zZXJ0IHNlcGFyYXRvciBoZXJlXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmxpbmtTZXBhcmF0b3IpXHJcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5saW5rU2VwYXJhdG9yID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIClcclxuXHJcblxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAuc2V0TmFtZShcIlZlcnNlIHByZWZpeFwiKVxyXG4gICAgICAgICAgICAuc2V0RGVzYygnRmlsbCB0aGlzIGlmIHlvdSBhcmUgdXNpbmcgdmVyc2UgcHJlZml4ZXMgaW4geW91ciBiaWJsZSBmaWxlcywgZS5nLiB5b3UgaGF2ZSBcInYxXCIgaW4geW91ciBmaWxlIFx1MjE5MiBzZXQgdG8gXCJ2XCIuJylcclxuICAgICAgICAgICAgLnNldENsYXNzKFwiaW1wb3J0YW50LXNldHRpbmdcIilcclxuICAgICAgICAgICAgLmFkZFRleHQoKGlucHV0Qm94KSA9PlxyXG4gICAgICAgICAgICAgICAgaW5wdXRCb3hcclxuICAgICAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoXCJJbnNlcnQgcHJlZml4IGhlcmVcIilcclxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MudmVyc2VQcmVmaXgpXHJcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy52ZXJzZVByZWZpeCA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICApXHJcblxyXG5cclxuICAgICAgICBjb250YWluZXJFbC5jcmVhdGVFbChcImg0XCIsIHsgdGV4dDogXCJEZWZhdWx0c1wiIH0pO1xyXG5cclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoXCJMaW5rIHR5cGUgZGVmYXVsdCB2YWx1ZVwiKVxyXG4gICAgICAgICAgICAuc2V0RGVzYyhcIlZhbHVlIHRoYXQgd2lsbCBiZSBzZWxlY3RlZCBieSBkZWZhdWx0IGluIGxpbmsgbW9kYWwuXCIpXHJcbiAgICAgICAgICAgIC5hZGREcm9wZG93bigoZHJvcGRvd24pID0+IHtcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbihMaW5rVHlwZS5CYXNpYywgTGlua1R5cGUuQmFzaWMpXHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24oTGlua1R5cGUuRW1iZWRkZWQsIExpbmtUeXBlLkVtYmVkZGVkKVxyXG4gICAgICAgICAgICAgICAgZHJvcGRvd24uYWRkT3B0aW9uKExpbmtUeXBlLkludmlzaWJsZSwgTGlua1R5cGUuSW52aXNpYmxlKVxyXG4gICAgICAgICAgICAgICAgZHJvcGRvd24uc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubGlua1R5cGVQcmVzZXQpXHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5saW5rVHlwZVByZXNldCA9IHZhbHVlIGFzIExpbmtUeXBlO1xyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfSlcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKFwiVXNlIG5ldyBsaW5lcyBkZWZhdWx0IHZhbHVlXCIpXHJcbiAgICAgICAgICAgIC5zZXREZXNjKFwiVmFsdWUgdGhhdCB3aWxsIGJlIHNlbGVjdGVkIGJ5IGRlZmF1bHQgaW4gbGluayBtb2RhbC5cIilcclxuICAgICAgICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG4gICAgICAgICAgICAgICAgdG9nZ2xlXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm5ld0xpbmVQcmVzZXQpXHJcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5uZXdMaW5lUHJlc2V0ID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIClcclxuXHJcbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoXCJoNFwiLCB7IHRleHQ6IFwiTWlzY1wiIH0pO1xyXG5cclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoXCJWZXJpZnkgZmlsZXM/XCIpXHJcbiAgICAgICAgICAgIC5zZXREZXNjKFwiVmVyaWZ5IGV4aXN0ZW5jZSBvZiBmaWxlcyB5b3UgYXJlIHRyeWluZyB0byBsaW5rLCBzbyB0aGF0IHlvdSBhcmUgbm90IGluc2VydGluZyB3cm9uZyByZWZlcmVuY2VzIGJ5IG1pc3Rha2UuXCIpXHJcbiAgICAgICAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cclxuICAgICAgICAgICAgICAgIHRvZ2dsZVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy52ZXJpZnlGaWxlc1doZW5MaW5raW5nKVxyXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MudmVyaWZ5RmlsZXNXaGVuTGlua2luZyA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICApXHJcblxyXG5cclxuICAgIH1cclxufVxy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
